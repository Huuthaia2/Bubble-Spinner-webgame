!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("crypto-js")):"function"==typeof define&&define.amd?define(["crypto-js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CryptoJS)}(this,function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o,n,u,r,a,s,i,c,d,h=t(e);function m(e,o,a,c){return new(a=a||Promise)(function(s,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function i(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?s(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}r((c=c.apply(e,o||[])).next())})}const l={OK:"OK",UNSUPPORTED_API:"UNSUPPORTED_API",TIMEOUT:"TIMEOUT",INVALID_PARAM:"INVALID_PARAM",NOT_READY:"NOT_READY",ADS_NO_FILL:"ADS_NO_FILL",AD_LOAD_FAILED:"AD_LOAD_FAILED",AD_DISMISSED:"AD_DISMISSED",AD_NOT_LOADED:"AD_NOT_LOADED",AD_ALREADY_LOADED:"AD_ALREADY_LOADED",AD_ALREADY_SHOWED:"AD_ALREADY_SHOWED"},g={CODE:l,OK:{code:l.OK,message:"Success"},TIMEOUT:{code:l.TIMEOUT,message:"timeout"},adLoadFail:{code:l.AD_LOAD_FAILED,message:"Ad load failed"},adDismissed:{code:l.AD_DISMISSED,message:"Ad dismissed"},adNotLoaded:{code:l.AD_NOT_LOADED,message:"Ad not loaded"},adAlreadyLoaded:{code:l.AD_ALREADY_LOADED,message:"Ad already loaded"},adAlreadyShowed:{code:l.AD_ALREADY_SHOWED,message:"Ad already showed"}};function y(s,e){return m(this,void 0,void 0,function*(){return new Promise(function(e,t){t(s)})})}(Pt=o=o||{}).emptyWait=function(s){return m(this,void 0,void 0,function*(){return new Promise(function(e,t){s?t(new Error("Failed by design")):e()})})},Pt.emptyWaitObject=function(s){return m(this,void 0,void 0,function*(){return new Promise(function(e,t){e(s)})})},Pt.emptyWaitBool=function(s,e){return m(this,void 0,void 0,function*(){return new Promise(function(e,t){e(s)})})},Pt.emptyWaitString=function(s,e){return m(this,void 0,void 0,function*(){return new Promise(function(e,t){e(s)})})},Pt.emptyWaitError=y,Pt.emptyWaitUnsupportApi=function(t){return m(this,void 0,void 0,function*(){return y((e=t,{code:g.CODE.UNSUPPORTED_API,message:"unsupport api:"+e}));var e})},Pt.generateId=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)};class p{constructor(e=null,t="SOLO"){this._sId=e,this._sType=t}static get currentContext(){return this._currentContext||(this._currentContext=new p),this._currentContext}static set currentContext(e){this._currentContext=e}getID(){return this._sId}getType(){return this._sType}isSizeBetween(e,t){return{answer:!1,minSize:e||0,maxSize:t||0}}switchAsync(e){return this._sId=e,o.emptyWaitObject(null)}chooseAsync(e){return o.emptyWaitUnsupportApi("context.chooseAsync")}createAsync(e){return o.emptyWaitUnsupportApi("context.createAsync")}getPlayersAsync(){return o.emptyWaitObject([])}}let f="_minigame_data_",A={},w=!1;function v(e,t){if(null==e||""===e.trim())throw{code:g.CODE.INVALID_PARAM,message:"Invalid key: "+e};e=A[e];return void 0!==e?e:t}function _(e,t){if(null==e||""===e.trim())throw{code:g.CODE.INVALID_PARAM,message:"Invalid key: "+e};A[e]=t}function b(){try{var e=JSON.stringify(A);localStorage.setItem(f,e),localStorage.flush&&localStorage.flush()}catch(e){console.error("LocalCache.flush error: ",e)}}class P{constructor(){this._configUrl="",this._gameId="",this._appId="",this._channel="",this._channelName="",this._minigameOption=null,this._playPageData=null,this._locationSearch=""}get configUrl(){return this._configUrl}get gameId(){return this._gameId}get appId(){return this._appId}get channel(){return this._channel}get channelName(){return this._channelName}get minigameOption(){return this._minigameOption}get playPageData(){return this._playPageData}set playPageData(e){this._playPageData=e}get locationSearch(){return this._locationSearch=window.location.search,this._locationSearch}static get instance(){return this._instance||(this._instance=new P),this._instance}init(e){this._channel=this.getSubChannelName(),this._channelName=this.getChannelName(),this._minigameOption=e,this._gameId=`${e.game_id}`,this._appId=`${e.app_id}`,this._locationSearch=window.location.search,window.commonInfo=P}getChannelName(){return window.globalPlatformInfo.channelName||window.channelName||this._playPageData.channelName}getSubChannelName(){return window.globalPlatformInfo.subChannelName||window.subChannelName||this._playPageData.subChannelName}getGameManifestJsonUrl(){return this._playPageData.gameManifestJsonUrl}isH5AndroidApp(){return this._minigameOption?this._minigameOption.android?this._minigameOption.android.enabled:(console.warn("minigame config has not android field!!!"),!1):(console.warn("minigame config is not exist!!!"),!1)}isAdflyEnable(){return this._minigameOption?this._minigameOption.cpl?this._minigameOption.cpl.adflyer?this._minigameOption.cpl.adflyer.enabled:(console.warn("cpl config has not adflyer field!!!"),!1):(console.warn("minigame config has not cpl field!!!"),!1):(console.warn("minigame config is not exist!!!"),!1)}getAdflyChannelID(){return this.isAdflyEnable()?this._minigameOption.cpl.adflyer.channelId:""}}P._instance=null;const S=P.instance,I={addCallbackEvent(e){e&&0<e.length&&e.forEach(t=>{t.ele&&t.ele.addEventListener(t.eventName,e=>{t.eventFunc&&t.eventFunc(e)})})},createDailogContainer(){let e=document.getElementById("minigameDailogContainer");return e||(e=document.createElement("div"),e.setAttribute("id","minigameDailogContainer"),e.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;top:0;  z-index: 20000; overflow: hidden; width: 100vw;height: 100vh; background-color: rgb(0, 0, 0,0.6);"),document.body.append(e)),e},removeDailogContainer(e){const t=document.getElementById("minigameDailogContainer");t&&t.childNodes&&t.childNodes.length<=1?t&&t.remove():e&&e instanceof Function&&e()}};let T;function R(e,t){var s,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");const i=[];let r;if(t=t||n.length,e)for(r=0;r<e;r++)i[r]=n[0|Math.random()*t];else for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",r=0;r<36;r++)i[r]||(s=0|16*Math.random(),i[r]=n[19===r?3&s|8:s]);return i.join("")}class C{static getTimestamp(){return(new Date).getTime()}static getTimeBySecond(){return Math.floor((new Date).getTime()/1e3)}static getDate(){return(new Date).toLocaleDateString()}static getTargetTimestamp(e=0,t=0,s=0){var n=new Date((new Date).toLocaleDateString()).getTime();return new Date(n+1e3*(3600*e+60*t+s)).getTime()}static waitTime(t,s){return new Promise(e=>{setTimeout(()=>{s&&s(),e()},t)})}}(Mt=n=n||{}).json="application/json",Mt.form="application/x-www-form-urlencoded; charset=UTF-8",(Ut=u=u||{}).get="GET",Ut.post="POST";const x=new class{constructor(){this.handleUrl=e=>t=>{if(t){const s=[];Object.keys(t).forEach(e=>s.push(e+"="+encodeURIComponent(t[e]))),-1===e.search(/\?/)?"object"==typeof t&&(e+="?"+s.join("&")):e+="&"+s.join("&")}return e}}getFetch(t,e,s){return m(this,void 0,void 0,function*(){return s={method:u.get,headers:{"Content-Type":n.json}},yield fetch(this.handleUrl(t)(e),s).then(e=>e.ok?e.json():Promise.reject("request failed with status "+e.status)).then(e=>e).catch(e=>Promise.reject(`get ${t} fail`+e.message))})}postFetch(n,i){return m(this,void 0,void 0,function*(){const t=new FormData;Object.keys(i).forEach(e=>t.append(e,i[e]));const e=new Headers;e.append("Content-Type","application/json");var s={method:u.post,headers:e,body:JSON.stringify(i),redirect:"follow"};return yield fetch(n,s).then(e=>e.ok?e.json():Promise.reject({code:e.status,message:`post ${n} fail status: ${e.status}`})).then(e=>(console.info(`post ${n} success response: ${JSON.stringify(e)}`),e)).catch(e=>Promise.reject({code:"server error",message:`post ${n} fail`+e.message}))})}};function k(e,t){return m(this,void 0,void 0,function*(){return x.postFetch(e,t)})}function D(t,s,n=3){return m(this,void 0,void 0,function*(){return n<3&&(yield C.waitTime(1e3)),k(t,s).then(e=>Promise.resolve(e)).catch(e=>0<n?(console.error(`post ${t} retry ${n} times`),D(t,s,n-1)):Promise.reject({code:"fetch retry failed",message:`post ${t} fail`+e}))})}class E{}E.PAY_IP="https://purchase2.minigame.vip",E.MINI_ORDER_ID="v2/purchase/miniorder",E.SET_DATA="v1/archive",E.GET_DATA="v1/archive",E.STORAGE_IP="https://storage.minigame.vip:30443";class O{}O.ADS_NETWORK_NOT_FOUND="ADS_NETWORK_NOT_FOUND";class j{}j.DOMAIN="https://ingress.minigame.vip:30443",j.API_PATH="/v1/mam/api/mda/random",j.BATCH_API_PATH="/v1/mam/api/mda/batch_random",(Wt=Ft=Ft||{})[Wt.AdTypeEnumNull=0]="AdTypeEnumNull",Wt[Wt.Display=1]="Display",Wt[Wt.Float=2]="Float",Wt[Wt.Banner=3]="Banner",Wt[Wt.Interstitial=4]="Interstitial",Wt[Wt.Rewarded=5]="Rewarded",(zt=r=r||{}).WAITING="0",zt.PAYING="1",zt.SUCCESS="2";class N{constructor(){this._curProducts=[],this._curProductInfos=[]}static getInstance(){return this._instance||(this._instance=new N),this._instance}init(t){return m(this,void 0,void 0,function*(){N._instance=this;try{emoPaySDK.api.initSDK(t),console.info("inititial emo pay sdk success")}catch(e){return z.showWithInit("OK","Payment initialization failed"),Promise.reject({code:"emoPay init fail",message:e.message})}try{var e=yield this.query();return this._curProducts.length=0,this._curProducts=this._curProducts.concat(e),console.info("query goods info: ",this._curProducts),Promise.resolve()}catch(e){return Promise.reject({code:"query goods fail",message:e.message})}})}pay(i,r){return m(this,void 0,void 0,function*(){let e=!1;try{e=yield this.checkLoginAsync()}catch(e){return z.showWithInit("OK",`Network error, please check 
if the network is available`),Promise.reject({code:"pay error",message:e.message})}if(!e)return z.showWithInit("Login",`You are currently not logged in, 
or the token has expired, 
please log in again`,()=>{L.show()}),Promise.reject({code:"login error",message:"without login, please login frist."});try{const s={};s.orderNo=r||R(),s.productId=i;var t=yield this.buyGoods(s);const n={paymentID:"",signedRequest:""};return n.productID=i,n.purchaseTime=t.paidTime,n.purchaseToken=t.cpOrderNo,Promise.resolve(n)}catch(e){return z.showWithInit("OK","Payment failed, please pay again"),Promise.reject({code:"pay fail",message:e.message})}})}query(){return new Promise((n,i)=>{emoPaySDK.api.requestGoods(e=>{0!==e.code&&i({code:"request goods fail",message:e.msg}),null!=e.data&&0!==e.data.length||i({code:"request goods empty",message:"request goods empty"});const s=[],t=e.data;this._curProductInfos=t,t.forEach(e=>{const t={};t.title=e.goodsName,t.price=`${e.amount}`,t.productID=e.goodsId,t.description=e.goodsExp,t.priceCurrencyCode="",t.imageURI="",s.push(t)}),n(s)})})}queryUncomsume(){return m(this,void 0,void 0,function*(){try{var e=yield D(`${E.PAY_IP}/${E.MINI_ORDER_ID}/query`,{thirdUid:emoPaySDK.api.getUserId()});console.log("query uncomsume orderInfos: ",e);const t=e.paidMiniOrders,n=[];return t.forEach(t=>{var e=this._curProducts.filter(e=>e.productID===t.productId)[0];const s={paymentID:"",purchaseTime:""};s.productID=e.productID,s.purchaseToken=t.thirdOrderId,s.signedRequest="",n.push(s)}),Promise.resolve(n)}catch(e){return Promise.reject({code:"query uncomsume order",message:e.message})}})}consume(e){return m(this,void 0,void 0,function*(){try{yield D(`${E.PAY_IP}/${E.MINI_ORDER_ID}/consume`,{mini_order_id:e});return Promise.resolve()}catch(e){return Promise.reject({code:"consume_fail",message:e.message})}})}onReady(e){}checkUserLoginStatus(){return new Promise((t,s)=>{emoPaySDK.api.checkUserLoginStatus(e=>{0===e?t(!0):-1===e||-2===e?t(!1):s({code:"check user login status error",message:JSON.stringify(e)})})})}buyGoods(i){return console.info("=====> pay options: ",i),new Promise((t,s)=>{var e,n=this._curProductInfos.filter(e=>e.goodsId===i.productId)[0];null!=n?(e={game_id:S.gameId},e=JSON.stringify(e),console.info("=====> emoPay buyGoods ing"),emoPaySDK.api.buyGoods(n,i.orderNo,e,"http://purchase.minigame.vip/v2/purchase/emo/callback",e=>{console.info("emoPay buyGoods response: ",e),0===e.code&&null!=e.data?e.data.paySt===r.SUCCESS?(console.info("pay success"),t(e.data)):(console.info("pay fail"),s({code:"pay fail",message:e.msg})):s({code:"buy goods fail",message:e.msg})})):s({message:"product not found"})})}guestLogin(){return new Promise((t,s)=>{emoPaySDK.api.guestLogin(e=>{0===e.code?(console.info("guest login success"),t()):(console.info("guest login fail"),s({code:"guest login fail",message:e.msg}))})})}sendVerifyCode(e){return new Promise((t,s)=>{emoPaySDK.api.requestOpt(e,e=>{0===e.code?t():s({code:"send verify code fail",message:e.msg})})})}phoneLogin(e,n){return new Promise((t,s)=>{emoPaySDK.api.phoneLogin(e,n,e=>{0===e.code?t():s({code:"phone login fail",message:e.msg})})})}userLogin(e,t){return this.phoneLogin(e,t)}getUserId(){return emoPaySDK.api.getUserId()||""}getUserToken(){return emoPaySDK.api.getUserToken()}checkLoginAsync(){return m(this,void 0,void 0,function*(){try{var e=yield this.checkUserLoginStatus();return e&&V.storageType!==a.Cloud||!e?Promise.resolve(!1):Promise.resolve(!0)}catch(e){return Promise.reject({code:"check Login error",message:e.message})}})}}const B=N.getInstance(),q={};q.EmoPay=N;class ${static getClass(e,t){return void 0===q[e]||null===q[e]?(console.warn(`未找到 className：${e} 对应实现`),null):new q[e](t)}static checkValidClass(e){return void 0===q[e]||null===q[e]?null:e}}let M=document;function U(r,o=!1,a){return m(this,void 0,void 0,function*(){return new Promise((e,t)=>{const s=M.createElement("script");if(s.src=r,s.async=o,a)for(const i in a)s.setAttribute(i,a[i]);const n=()=>{s.removeEventListener("load",n),e()};s.addEventListener("load",n),s.addEventListener("error",e=>{console.error(e),t(new Error(`Failed to load ${r}`))}),(M.getElementsByTagName("head")[0]||document.documentElement).appendChild(s)})})}const F=class Ht{constructor(){this._payPlatormInfo=null,this._curPayment=null,this._isPayEnable=!1,this._inited=!1}static get instance(){return this._instance||(this._instance=new Ht),this._instance}set payEnable(e){this._isPayEnable=e}get payEnable(){return this._isPayEnable}get inited(){return this._inited}init(e){throw new Error("Method not implemented.")}pay(e,t){return console.info("=====> pay productID: ",e),this._inited?this._curPayment?this._curPayment.pay(e,t):(console.error("purchase fail no payment selected"),Promise.reject({code:"purchaseAsync fail",message:"no payment selected"})):(z.showWithInit("OK",`The payment initialization failed. 
Please restart the game if you 
want to make a payment.`),Promise.reject({code:"fail to initialize payment",message:"payment inited false"}))}query(){return m(this,void 0,void 0,function*(){if(!this._curPayment)return Promise.reject({code:"getCatalogAsync fail",message:"no payment selected"});try{var e=yield this._curPayment.query();return console.info("get products : ",e),e}catch(e){return Promise.reject({message:"getCatalog fail "+e.message})}})}queryUncomsume(){return this._curPayment?this._curPayment.queryUncomsume():Promise.reject({code:"getPurchasesAsync fail",message:"no payment selected"})}consume(e){return this._curPayment?this._curPayment.consume(e):Promise.reject({code:"consumePurchaseAsync fail",message:"no payment selected"})}onReady(e){this._curPayment?this._curPayment.onReady(e):console.error("no payment selected")}fetchPayConfig(n){return m(this,void 0,void 0,function*(){try{const t=yield fetch(n);if(404===t.status)return Promise.reject({code:"fetchPayConfig fail "+n});const s=(yield t.json()).infos;var e=s.filter(e=>e.enabled)[0];return this._curPayment=$.getClass(e.id),this._payPlatormInfo=e,this._curPayment?(console.info("load pay config: ",n),this._isPayEnable=!0,Promise.resolve()):Promise.reject({code:"this._curPayment null "+e.id})}catch(e){return Promise.reject({message:"fetchPayConfig fail "+e.message})}})}loadSDK(){return m(this,void 0,void 0,function*(){try{return yield U(this._payPlatormInfo.sdkUrl,!0),console.info("load pay dk: ",this._payPlatormInfo.sdkUrl),Promise.resolve()}catch(e){return Promise.reject({message:"load pay sdk fail "+e.message})}})}loadPayment(e){return m(this,void 0,void 0,function*(){try{return yield this.fetchPayConfig(e),yield this.loadSDK(),this._curPayment.init(this._payPlatormInfo.channel),this._inited=!0,Promise.resolve()}catch(e){return Promise.reject({code:"loadPayment fail",message:e.message})}})}setPayment(e){e?this._curPayment=e:console.error("payment is null")}getUserId(){return this._curPayment?this._curPayment.getUserId():""}guestLogin(){return this._curPayment?this._curPayment.guestLogin():Promise.reject({code:"payHelper guestLogin fail",message:"this _curPayment is null"})}userLogin(e,t){return this._curPayment?this._curPayment.userLogin(e,t):Promise.reject({code:"payHelper userLogin fail",message:"this _curPayment is null"})}checkLoginAsync(){return this._curPayment?this._curPayment.checkLoginAsync():Promise.reject({code:"checkLoginAsync fail",message:"no payment selected"})}}.instance,L={currentCtx:null,show(){const i=document.createElement("div");i.setAttribute("style","position: absolute;z-index:1;width:100%;height:100%"),i.innerHTML=`    
      <div style="position: absolute;  left: 0;    top: 0;  bottom: 0;  right: 0;  margin: auto;  width: 289px;  height: 289px;   background: #FFFFFF; box-shadow: 0px 2px 7px 0px rgba(143, 143, 143, 0.48);  border-radius: 11px;    display: flex;flex-direction: column;align-items: center;justify-content: center;   ">
          <div id="registerCloseBtn" style="position: absolute;right: 10px;top: 10px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                  <path style="fill: #4398FE "
                      d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z">
                  </path>
                  <path fill="none" d="M0 0h24v24H0V0z"></path>
              </svg>
          </div>
          <div id="registerError" style="position: absolute;right: 37px;top: 139px;font-size: 6px;font-weight: 400;color: #FB4242;"></div>
          <div style="width: 202px;height: 17px;font-size: 15px;font-family: Microsoft YaHei;font-weight: bold;color: #010101;">Login with Phone Number</div>
          <div style="margin-top:15px;width: 218px;height: 30px;border: 1px solid #BABABA;border-radius: 6px;display: flex;flex-direction: row;align-items: center;justify-content: center;"><div style="    width: 46px;border-right: 1px solid #CECECE ;"><select style="border: none;outline: none;" name="registerAreacode" id="registerAreacode">
              <option value="91">+91</option>
              <option value="1">+1</option>
          </select></div><div style="flex: 1;"><input style="font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #515151;;background-color:transparent;border:0;width:90%;outline:none;margin-left: 6px;"
              type="text" id="registerPhone" name="registerPhone" required placeholder="Please fill in the phone"></div></div>
          <div id="registerSendBtn" style="margin-top:12px;font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFFFF;width: 218px;height: 35px;background: #4398FE;border-radius: 6px;display: flex;flex-direction: column;align-items: center;justify-content: center;">Send</div>                    
          <div id="registerSendText" style="display: none;;text-align: center;margin-top:11px;font-size: 10px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFFFF;width: 218px;height: 35px;background: #BABABA;border-radius: 6px;    padding-top: 3px;box-sizing: border-box;">Wait tor <span id="registerTime">60</span> s <br>To Request Another Code</div>
          <div style="margin-top:15px;width: 218px;height: 30px;border: 1px solid #BABABA;border-radius: 6px;display: flex;flex-direction: column;align-items: center;justify-content: center;"><input style="font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #515151;;background-color:transparent;border:0;width:90%;outline:none" type="text" id="registerVfcode" name="registerVfcode" required placeholder="Verification Code"> </div>
          <div id="registerLoginBtn" style="margin-top:12px;font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFFFF;width: 218px;height: 35px;background: #4398FE;border-radius: 6px;display: flex;flex-direction: column;align-items: center;justify-content: center;">Login</div>
          <div style="margin-top: 15px;    text-align: center;width: 210px;height: 17px;font-size: 8px;font-family: Microsoft YaHei;font-weight: 400;color: #010101;">By proceeding, you agree to our <span><a href="" target="_blank" style="color: #4398FE;" > Terms & Conditions</a></span>& <span><a href="" target="_blank" style="color: #4398FE;">Privacy Policy.</a></span></div>
      </div>`,I.createDailogContainer().append(i),this.currentCtx=i,i&&(this.initRegisterUi([91,86]),I.addCallbackEvent([{ele:i.querySelector("#registerCloseBtn"),eventName:"click",eventFunc:()=>{this.hide()}},{ele:i.querySelector("#registerSendBtn"),eventName:"click",eventFunc:()=>m(this,void 0,void 0,function*(){i.querySelector("#registerSendBtn")&&(i.querySelector("#registerSendBtn").style.display="none"),i.querySelector("#registerSendText")&&(i.querySelector("#registerSendText").style.display="block"),this.countdownFunc(60);try{var e=`${document.getElementById("registerAreacode")&&document.getElementById("registerAreacode").value||""}${document.getElementById("registerPhone")&&document.getElementById("registerPhone").value||""}`;yield B.sendVerifyCode(e),console.info("sendVerifyCode success")}catch(e){console.error("sendVerifyCode error",e)}})},{ele:i.querySelector("#registerLoginBtn"),eventName:"click",eventFunc:()=>m(this,void 0,void 0,function*(){var e=i.querySelector("#registerAreacode")&&i.querySelector("#registerAreacode").value||"",t=i.querySelector("#registerPhone")&&i.querySelector("#registerPhone").value||"",s=i.querySelector("#registerVfcode")&&i.querySelector("#registerVfcode").value||"";if(10===t.length&&/^\d{1,}$/.test(t))if(0!==s.length){var n,e=`${e}${t}`;try{W.init(),W.show(),yield F.userLogin(e,s),console.info("phoneLogin success"),V.storageType===a.Local?(n=yield V.checkNewUser(),V.storageType=n?a.Cloud:a.Local,V.userPhone=n?t:"",W.hide()):(W.hide(),V.storageType=a.Cloud,V.userPhone=t,G.success({message:"Login success",autoCloseTime:2,top:"50%",left:"50%"})),this.hide()}catch(e){console.error("phoneLogin error",e),W.hide(),this.hide(),z.showWithInit("OK","Login failed, please try again",()=>{L.show()})}}else this.displayErrorMessage("verification code error");else this.displayErrorMessage("phone number error")})},{ele:i.querySelector("#registerPhone"),eventName:"input",eventFunc:e=>{const t=e.target.value||"";/^\d+$/.test(t)?this.displayErrorMessage(""):(e.target.value=t.replace(/\D+/,""),this.displayErrorMessage("Please key in numbers!"))}}]))},hide(){I.removeDailogContainer(()=>{this.currentCtx&&this.currentCtx.remove()})},displayErrorMessage(e){const t=this.currentCtx.querySelector("#registerError");t&&(t.innerText=e)},addCallbackEvent(e){e&&0<e.length&&e.forEach(t=>{t.ele&&t.ele.addEventListener(t.eventName,e=>{t.eventFunc&&t.eventFunc(e)})})},countdownFunc(e){const s=this.currentCtx,n=s.querySelector("#registerTime");return function e(t){n.innerText=t,t--,setTimeout(()=>{0<(n.innerText=t)?e(t):(s.querySelector("#registerSendBtn")&&(s.querySelector("#registerSendBtn").style.display="flex"),s.querySelector("#registerSendText")&&(s.querySelector("#registerSendText").style.display="none"))},1e3)}(e)},initRegisterUi(e){const s=this.currentCtx.querySelector("#registerAreacode");e&&0<e.length&&s&&(s.innerHTML="",e.forEach(e=>{const t=document.createElement("option");t.setAttribute("value",`${e}`),t.innerText=`+${e}`,s.appendChild(t)}))}},W={currentCtx:null,btn:{name:"",func:()=>{W.hide()}},init(e){return this.btn.name="",this.btn.func=()=>{W.hide()},e&&(this.btn.name=e.btnName,this.btn.func=e.btnFunc),this.btn.hidden=!(0<this.btn.name.length),this},show(){var e=`
      <div style="margin-top: -25px;top: 50%;width: 100%;text-align: center;position: absolute;display: flex;flex-direction: column;justify-content: center;align-items: center;">
          <svg  t="1655447361916" style="animation: waitRotating 2s linear infinite;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3916" width="10" height="10"><path d="M768 576v-128h192v128h-192z m-120.32-290.24l136-135.68 90.24 90.24-135.68 136zM448 768h128v192h-128v-192z m0-704h128v192h-128V64zM150.08 783.68l135.68-136 90.56 90.56-136 135.68z m0-543.36l90.24-90.24 136 135.68-90.56 90.56zM256 576H64v-128h192v128z m617.92 207.68l-90.24 90.24-136-135.68 90.56-90.56z" fill="#409EFF" p-id="3917"></path></svg>
          <p style="color: #409EFF;margin: 3px 0;font-size: 14px;">Loading...</p>
          ${this.btn.name?`<div id="css_wait_ctx_cancel" style="margin-top: 25px;width: 130px;text-align: center;background: #fff;height: 30px;line-height: 30px;border-radius: 30px;">${this.btn.name}</div>`:""}
      </div>
      `;const t=document.createElement("div");t.setAttribute("style","position: absolute;z-index:10;width:100%;height:100%;transition: opacity .3s;background-color: rgb(0, 0, 0,0.6);"),t.innerHTML=e;const s=document.createElement("style");s.id="css_wait_style",s.type="text/css",s.innerHTML=`
    @keyframes waitRotating {
        0% {
        transform: rotateZ(0);
        }
        100% {
            transform: rotateZ(360deg);
        }
    }
    `,t.appendChild(s),I.createDailogContainer().append(t),this.currentCtx=t;const n=t.querySelector("#css_wait_ctx_cancel");n&&n.addEventListener("click",()=>{this.btn.func&&this.btn.func(),this.hide()})},hide(){I.removeDailogContainer(()=>{this.currentCtx&&this.currentCtx.remove()})}},G={success({autoCloseTime:e,message:t,top:s,left:n}){const i=e||1,r=s||"50%";n=n||"50%";const o=document.createElement("div");o.innerHTML=`<div style="transition: all 0.5s ease-out;border: 1px solid #e1f3d8;color:#67c23a;background: #f0f9eb;max-width: 300px;min-height: 20px;position: fixed;top: -100%;left:${n};transform: translate(-50%,-50%);z-index: 20001;border-radius: 4px;word-break: break-word;padding: 10px;">
                <div>
                    <svg t="1655970966078" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2181"
                        width="20" height="20">
                        <path
                            d="M512 1024C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z m-114.176-310.954667a53.333333 53.333333 0 0 0 75.434667 0l323.328-323.328a53.333333 53.333333 0 1 0-75.434667-75.434666l-287.914667 283.306666-128.853333-128.853333a53.333333 53.333333 0 1 0-75.434667 75.434667l168.874667 168.874666z"
                            fill="#67c23a" p-id="2182"></path>
                    </svg>
                </div>
                <div>${t}</div>
            </div>`,document.body.append(o),setTimeout(()=>{o.firstChild.style.top=r},500),setTimeout(()=>{var e=`${o.firstChild.getBoundingClientRect()&&o.firstChild.getBoundingClientRect().height/2||0}px`;o.firstChild.style.top=e,setTimeout(()=>{o.remove()},1e3*i)},1e3)},error({autoCloseTime:e,message:t,top:s,left:n}){e&&(this.autoCloseTime=e);const i=e||1,r=s||"50%";n=n||"50%";const o=document.createElement("div");o.innerHTML=`<div  style="transition: all 0.5s ease-out;border: 1px solid #fde2e2;color:#f56c6c;background: #fef0f0;max-width: 300px;min-height: 20px;position: fixed;top: -100%;left:${n};transform: translate(-50%,-50%);z-index: 20001;border-radius: 4px;word-break: break-word;padding: 10px;">
                <div>
                    <svg t="1655971895182" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3456" width="20" height="20"><path d="M827.392 195.584q65.536 65.536 97.792 147.456t32.256 167.936-32.256 167.936-97.792 147.456-147.456 98.304-167.936 32.768-168.448-32.768-147.968-98.304-98.304-147.456-32.768-167.936 32.768-167.936 98.304-147.456 147.968-97.792 168.448-32.256 167.936 32.256 147.456 97.792zM720.896 715.776q21.504-21.504 18.944-49.152t-24.064-49.152l-107.52-107.52 107.52-107.52q21.504-21.504 24.064-49.152t-18.944-49.152-51.712-21.504-51.712 21.504l-107.52 106.496-104.448-104.448q-21.504-20.48-49.152-23.04t-49.152 17.92q-21.504 21.504-21.504 52.224t21.504 52.224l104.448 104.448-104.448 104.448q-21.504 21.504-21.504 51.712t21.504 51.712 49.152 18.944 49.152-24.064l104.448-104.448 107.52 107.52q21.504 21.504 51.712 21.504t51.712-21.504z" p-id="3457" fill="#f56c6c"></path></svg>
                </div>
                <div>${t}</div>
            </div>`,document.body.append(o),setTimeout(()=>{o.firstChild.style.top=r},500),setTimeout(()=>{var e=`${o.firstChild.getBoundingClientRect()&&o.firstChild.getBoundingClientRect().height/2||0}px`;o.firstChild.style.top=e,setTimeout(()=>{o.remove()},1e3*i)},1e3)}},z={message:"Sorry,This account already exists,\nplease change a new account.\r\n\r\nIf you want switch account,\nplease click the button.",currentCtx:null,btn:{name:"OK",func:()=>{}},init(e){return this.message="",this.btn.name="",this.btn.func=()=>{},e&&(this.message=e.message,this.btn.name=e.btnName,this.btn.func=e.btnFunc),this},show(){var e=`    
    <div style="position: absolute;top: 50%;left: 50%;transform: translate(-50%,-50%);width: 278px;  min-height: 210px;   background: #FFFFFF; box-shadow: 0px 2px 7px 0px rgba(143, 143, 143, 0.48);  border-radius: 11px;    display: flex;flex-direction: column;align-items: center;">
        <div style="margin: 20px 0 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><div style="width:50px;height:50px;border-radius:50px;    background: url(/images/weiyou.png);background-position: center;background-repeat: no-repeat;background-size: contain;"></div>
        <div style="max-width:268px;padding: 10px 0;min-height: 80px;width: 100%;overflow: hidden;text-align: center;word-break: break-word;box-sizing: border-box;line-height: 20px;white-space: pre-wrap;word-break: break-word;">${this.message}</div>                
        <div id="confirmMessage" style=" margin-bottom: 20px;display: flex; justify-content: center; align-items: center;width: 230px; height: 35px; border-radius: 6px;background: #4398FE;  font-size: 13px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFF" >${this.btn.name}</div>
    </div>`;const t=document.createElement("div");t.setAttribute("style","position: absolute;z-index:1;width:100%;height:100%"),t.innerHTML=e,I.createDailogContainer().append(t),this.currentCtx=t,t&&I.addCallbackEvent([{ele:t.querySelector("#minigameDailogContainer #confirmMessage"),eventName:"click",eventFunc:()=>{this.removeUi(),this.btn.func&&this.btn.func instanceof Function&&this.btn.func()}}])},showWithInit(e,t,s){const n={};n.btnName=e,n.message=t,n.btnFunc=s,this.init(n),this.show()},removeUi(){I.removeDailogContainer(()=>{this.currentCtx&&this.currentCtx.remove()})}};const H=class Kt{constructor(){this.handleUrl=e=>t=>{if(t){const s=[];Object.keys(t).forEach(e=>s.push("keys="+t[e])),-1===e.search(/\?/)?"object"==typeof t&&(e+="?"+s.join("&")):e+="&"+s.join("&")}return e}}static get instance(){return this._instance||(this._instance=new Kt),this._instance}getDataAsync(c){return m(this,void 0,void 0,function*(){console.info("====> getData userId: ",F.getUserId()),""===F.getUserId()&&console.error("=====> userId is null");var e=u.get,t=`${S.channelName}_${S.channel}_${S.gameId}_${F.getUserId()}`;console.info("get data id: ",t);var s=(new Date).toUTCString().toString();const n=h.default.enc.Base64,i=h.default.HmacSHA512;let r=`/${E.GET_DATA}/${t}?`,o=`${E.PAY_IP}/dev/${E.GET_DATA}/${t}?`;c.forEach((e,t)=>{0!==t&&(o+="&",r+="&"),o+=`keys=${e}`,r+=`keys=${e}`}),t=n.stringify(i(`(request-target): get ${r}\nx-date: ${s}\ndigest: `,"HMACSHA512-SecretKey"));const a=new Headers;return a.append("Authorization",`Signature keyId="write",algorithm="hmac-sha512",headers="(request-target) x-date digest",signature="${t}"`),a.append("x-date",s),e={method:e,headers:a,redirect:"follow"},yield fetch(o,e).then(e=>e.ok?e.json():Promise.reject({code:e.status,message:`get ${o} fail status: ${e.status}`})).then(e=>(console.info(`get ${o} success response: ${JSON.stringify(e)}`),Promise.resolve(e.data))).catch(e=>(console.error(`get ${o} error: ${e.message}`),Promise.reject({code:"CloudStorage getData error",message:e.message})))})}setDataAsync(l){return m(this,void 0,void 0,function*(){""===F.getUserId()&&console.error("=====> userId is null");var e=u.post,t=(new Date).toUTCString().toString();const s=h.default.SHA256,n=h.default.enc.Base64,i=h.default.HmacSHA512;var r=`${S.channelName}_${S.channel}_${S.gameId}_${F.getUserId()}`;console.info("set data id: ",r);var o={id:r,data:l},a=`SHA-256=${n.stringify(s(JSON.stringify(o)))}`,r=n.stringify(i(`(request-target): post /${E.SET_DATA}\nx-date: ${t}\ndigest: ${a}`,"HMACSHA512-SecretKey"));const c=new Headers;c.append("Authorization",`Signature keyId="write",algorithm="hmac-sha512",headers="(request-target) x-date digest",signature="${r}"`),c.append("Content-Type","application/json"),c.append("x-date",t),c.append("digest",a),e={method:e,headers:c,body:JSON.stringify(o)};const d=`${E.PAY_IP}/dev/${E.SET_DATA}`;return console.info("=====> cloudStorage setData: ",JSON.stringify(o)),yield fetch(d,e).then(e=>e.ok?e.json():Promise.reject({code:e.status,message:`post ${d} fail status: ${e.status}`})).then(e=>(console.info(`post ${d} success response: ${JSON.stringify(e)}`),Promise.resolve())).catch(e=>(console.error("CloudStorage setData error: "+e.message),Promise.reject({message:"CloudStorage setData error: "+e.message})))})}}.instance;const K=class Vt{static get instance(){return this._instance||(this._instance=new Vt),this._instance}init(){}getDataAsync(e){if(!e||0===e.length)return Promise.reject({message:"LocalStorage getData keys null"});const t={};for(const s of e)t[s]=v(s);return console.info("======> get local data: ",t),Promise.resolve(t)}setDataAsync(e){if(!e)return Promise.reject({message:"LocalStorage setData data null"});for(const t in e)_(t,e[t]);return b(),console.info("======> set local data: ",e),Promise.resolve()}}.instance;(e=a=a||{}).Local="Local",e.Cloud="Cloud",e.None="None",(Pt=s=s||{}).GuestUid="guestUid",Pt.UserPhone="userPhone",Pt.StorageType="storageType";const V=class Yt{constructor(){this._storageType=a.None,this._guestUid="",this._userPhone=""}static get instance(){return this._instance||(this._instance=new Yt),this._instance}init(){K.init()}set storageType(e){this._storageType=e,_(s.StorageType,this._storageType),b()}get storageType(){return v(s.StorageType)&&(this._storageType=v(s.StorageType)),this._storageType}set guestUid(e){this._guestUid=e,_(s.GuestUid,this._guestUid),b()}get guestUid(){return v(s.GuestUid)&&(this._guestUid=v(s.GuestUid)),this._guestUid}set userPhone(e){this._userPhone=e,_(s.UserPhone,this._userPhone),b()}get userPhone(){return v(s.UserPhone)&&(this._userPhone=v(s.UserPhone)),this._userPhone}isNewUser(){return m(this,void 0,void 0,function*(){try{var e=A,t=Object.keys(e),s=yield H.getDataAsync(t),n=!s;return console.info(`====> check keys: ${t}/\n getData: ${s}\n !!getData: ${n}`),Promise.resolve(n)}catch(e){return console.error(`isNewUser error: ${e.message}`),Promise.reject({code:"isNewUser error",message:e.message})}})}checkNewUser(){return m(this,void 0,void 0,function*(){try{var e=yield this.isNewUser();return e?yield this.dealBindingAccountSuccess():this.dealExistAccountBinding(),Promise.resolve(e)}catch(e){return console.error(`checkNewUser error: ${e.message}`),Promise.reject({code:"checkNewUser error",message:`${e.message}`})}})}dealExistAccountBinding(){const e={btnName:"SWITCH"};e.message=`Sorry,This account already exists,
please change a new account.

If you want switch account,
please click the button.`,e.btnFunc=()=>{L.show()},z.init(e),z.show()}dealBindingAccountSuccess(){return m(this,void 0,void 0,function*(){try{return yield H.setDataAsync(A),G.success({message:"Register success.",autoCloseTime:2,top:"50%",left:"50%"}),Promise.resolve()}catch(e){return G.success({message:"Register fail.",autoCloseTime:2,top:"50%",left:"50%"}),Promise.reject({code:"fail save local data to cloud",message:e.message})}})}getDataAsync(e){return(this._storageType===a.Cloud?H:K).getDataAsync(e)}setDataAsync(e){return(this._storageType===a.Cloud?H:K).setDataAsync(e)}}.instance;class Y{getASID(){return""}getSignature(){return""}}class J{constructor(e,t=""){this._id=e,this._name=t}static get currentPlayer(){if(!this._currentPlayer){!function(t=""){if(!w){w=!0,null!==t&&(f+=t);t=localStorage.getItem(f);if(null!=t)try{var e=JSON.parse(t);A=e}catch(e){console.error("Failed to parse local data: "+t)}}}();let e=v(this.PLAYER_KEY,"");""===e&&(e=o.generateId(),_(this.PLAYER_KEY,e),b()),J._currentPlayer=new J(e)}return this._currentPlayer}getID(){return this._id}getSignedPlayerInfoAsync(e){return o.emptyWaitUnsupportApi("FBPlayer.getSignedPlayerInfoAsync")}canSubscribeBotAsync(){return o.emptyWaitBool(!1)}subscribeBotAsync(){return o.emptyWaitUnsupportApi("FBPlayer.subscribeBotAsync")}getName(){return this._name}getPhoto(){return""}getDataAsync(e){if(window.MiniGameAds&&window.MiniGameAds.isTest){const t={};for(const s of e)t[s]=v(s);return o.emptyWaitObject(t)}return console.info("=======> get data with keys: ",e),V.getDataAsync(e)}setDataAsync(e){if(console.info("=======> set data: ",e),window.MiniGameAds&&window.MiniGameAds.isTest){for(const t in e)_(t,e[t]);return b(),o.emptyWaitObject(null)}return V.setDataAsync(e)}flushDataAsync(){return b(),o.emptyWaitObject(null)}getStatsAsync(e){return this.getDataAsync(e)}setStatsAsync(e){return this.setDataAsync(e)}incrementStatsAsync(e){let t=!1;const s={};for(const r in e){if("number"!=typeof e[r]){t=!0;break}var n=v(r,0)+1;_(r,n),s[r]=n}var i=t?{code:-1,msg:"error! one or more data type not number!"}:s;return t||b(),o.emptyWaitObject(i)}getConnectedPlayersAsync(){return o.emptyWaitObject([])}getASIDAsync(){return o.emptyWaitObject(this.getID())}getSignedASIDAsync(){var e=new Y;return o.emptyWaitObject(e)}}function Q(n,i,r){void 0===i&&(i=0),void 0===r&&(r=50);let o,a;return new Promise(function(e,t){const s=function(){n()?(a&&clearTimeout(a),e()):o=setTimeout(s,r)};o=setTimeout(s,r),0<i&&(a=setTimeout(()=>{o&&clearTimeout(o),t(g.TIMEOUT)},i))})}J.PLAYER_KEY="_minigame_player_id_";const Z={preroll:"preroll",start:"start",pause:"pause",next:"next",browse:"browse",reward:"reward"},X={notReady:"notReady",timeout:"timeout",error:"error",noAdPreloaded:"noAdPreloaded",frequencyCapped:"frequencyCapped",ignored:"ignored",other:"other",dismissed:"dismissed",viewed:"viewed"};let ee=!1,te=0;const se=5;function ne(){return te<=0?0:te+se-Date.now()}function ie(e){return e===X.viewed||e===X.dismissed}function re(e){let t="UNKNOWN_ERROR",s=t;return e&&(e.breakStatus&&(t=e.breakStatus),s=`${e.breakFormat}:${e.breakType}:${e.breakName} error, status: ${e.breakStatus}`),oe(t,s)}function oe(e,t){return{code:e,message:t}}function ae(e){return e===Z.preroll}function ce(e){return e===Z.reward}let de=!1;function le(){if(!de){de=!0,console.info("===> checking Ads");try{adConfig({onReady:()=>{console.info("===> Ads are ready"),ee=!0,de=!1}})}catch(e){console.debug("===> Check Ready, got error: ",e),console.info("===> Assume Ads ready"),ee=!0,de=!1}}}function ue(n,i,r){return null!=r&&r.onShow(),console.info("===> showAdSenseAsync called: ",n,i),ce(n),new Promise((t,s)=>{if(!ae(n)){if(!ee)return void s(oe("notLoaded","ad not loaded"));if(!(ne()<=0))return void s(oe("notReady","ad not ready, wait: "+(ne()/1e3).toFixed(2)+" seconds"))}const e={type:n,name:i,adBreakDone:e=>{console.info("===> showAdSense:adBreakDone, type: "+n+", name: "+i,e),ie(e.breakStatus)?(te=Date.now(),null!=r&&r.onClose(),ee=!1,setTimeout(()=>{le()},100)):null!=r&&r.onFail(),ce(n)?e.breakStatus===X.viewed?t():s(re(e)):ie(e.breakStatus)?(null!=r&&r.onSuccess(),t()):(s(re(e)),null!=r&&r.onFail())}};ae(n)||(e.beforeAd=()=>{console.info("===> showAdSense:beforeAd, type: "+n+", name: "+i)},e.afterAd=()=>{console.info("===> showAdSense:afterAd, type: "+n+", name: "+i)}),ce(n)&&(e.beforeReward=e=>{console.info("===> showAdSense:beforeReward, type: "+n+", name: "+i),e(),null!=r&&r.onSuccess()},e.adDismissed=()=>{console.info("===> showAdSense:adDismissed, type: "+n+", name: "+i),null!=r&&r.onFail()},e.adViewed=()=>{console.info("===> showAdSense:adViewed, type: "+n+", name: "+i)}),console.info("===> showAdSense:tryShow, type: "+n+", name: "+i),adBreak(e)})}class he{constructor(){this._runningAsyncTask=null,this._queues=[],this._isProcessingTaskUUID=0,this._enable=!0,this.complete=null}get queues(){return this._queues}get enable(){return this._enable}set enable(e){this._enable!==e&&(this._enable=e)&&0<this.size&&this.play()}push(e,t=null){var s=he._$uuid_count++;return this._queues.push({uuid:s,callbacks:[e],params:t}),s}pushMulti(e,...t){var s=he._$uuid_count++;return this._queues.push({uuid:s,callbacks:t,params:e}),s}remove(t){var e;if((null===(e=this._runningAsyncTask)||void 0===e?void 0:e.uuid)!==t){for(let e=0;e<this._queues.length;e++)if(this._queues[e].uuid===t){this._queues.splice(e,1);break}}else console.warn("A running task cannot be removed")}get size(){return this._queues.length}get isProcessing(){return 0<this._isProcessingTaskUUID}get isStop(){return!(0<this._queues.length)&&!this.isProcessing}get runningParams(){return this._runningAsyncTask?this._runningAsyncTask.params:null}clear(){this._queues=[],this._isProcessingTaskUUID=0,this._runningAsyncTask=null}next(e,t=null){this._isProcessingTaskUUID===e?(this._isProcessingTaskUUID=0,this._runningAsyncTask=null,this.play(t)):this._runningAsyncTask&&console.info("====> runningAsyncTask: ",this._runningAsyncTask)}step(){this.isProcessing&&this.next(this._isProcessingTaskUUID)}play(s=null){if(!this.isProcessing&&this._enable){var n=this._queues.shift();if(n){const o=(this._runningAsyncTask=n).uuid;this._isProcessingTaskUUID=o;const a=n.callbacks;if(1===a.length)a[0]((e=null)=>{this.next(o,e)},n.params,s);else{let t=a.length;const c=[];var i=(e=null)=>{--t,c.push(e||null),0===t&&this.next(o,c)},r=t;for(let e=0;e<r;e++)a[e](i,n.params,s)}}else this._isProcessingTaskUUID=0,this._runningAsyncTask=null,this.complete&&this.complete(s)}}yieldTime(i,r=null){this.push(function(e,t,s){const n=setTimeout(()=>{clearTimeout(n),r&&r(),e(s)},i)},{des:"AsyncQueue.yieldTime"})}static excuteTimes(e,t=null){let s=e;return()=>{--s,0===s&&t&&t()}}}he._$uuid_count=1,(Mt=i=i||{}).PREROLL="preroll",Mt.INTERSTITIAL="interstitial",Mt.REWARDED="reward",Mt.BANNER="banner";class me{constructor(e,t,s,n){this._strategyName="AdsStrategy",this._placementId=e,this._isRewarded=t,this._isOpened=!0,this._type=this._isRewarded?i.REWARDED:i.INTERSTITIAL,console.info("AdsStrategy constructor placementId: type: strategyName",e,this._type,this._strategyName)}getPlacementID(){return this._placementId}getType(){return this._type}setType(e){this._type=e}getRewardedType(){return this._isRewarded}setRewardedType(e){this._isRewarded=e}getIsOpened(){return this._isOpened}setIsOpened(e){this._isOpened=e}getStrategyName(){return this._strategyName}setAdsCallback(e){this._adsCallback=e}getAdsCallbackOption(){return this._adsCallback}}class ge extends me{constructor(){super(...arguments),this._strategyName="AfgStrategy"}loadAsync(){return le(),Q(()=>ee,1e3).then(()=>(console.info("[AFG] Ads loaded"),Promise.resolve())).catch(e=>(console.info("[AFG] Ads load error: ",e),Promise.reject(e)))}showAsync(){return m(this,void 0,void 0,function*(){var e={isRewardedAd:this.getRewardedType(),placementId:this.getPlacementID(),uid:""},t=e.isRewardedAd?Z.reward:Z.next,e=e.placementId;console.info(`===> show ad: ${t}|${e}`);try{return yield ue(t,e,this.getAdsCallbackOption()),console.info("[AFG] show ads: success"),Promise.resolve()}catch(e){return console.info("[AFG] show ads: error: ",e),Promise.reject(e)}})}isReady(){return ee}}const ye={addCallbackEvent(e){e&&0<e.length&&e.forEach(t=>{t.ele&&t.ele.addEventListener(t.eventName,e=>{t.eventFunc&&t.eventFunc(e)})})},createDailogContainer(){let e=document.getElementById("minigameDailogContainer");return e||(e=document.createElement("div"),e.setAttribute("id","minigameDailogContainer"),e.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;top:0;  z-index: 20000; overflow: hidden; width: 100vw;height: 100vh; background-color: rgb(0, 0, 0,0.6);"),document.body.append(e)),e},removeDailogContainer(e){const t=document.getElementById("minigameDailogContainer");t&&t.childNodes&&t.childNodes.length<=1?t&&t.remove():e&&e instanceof Function&&e()}};class pe{constructor(e,t){this.currentContainerElement=null,this.currentContainerParentElement=null,this.currentSpecialContainerRootElement=null,this.ifCommonAd=!0,this.container=null,this.adProperties=null,this.adCloseCallback=null,this.adsCallBack=null,this.currentContainerElement=null,this.currentContainerParentElement=null,this.currentSpecialContainerRootElement=null,e&&e.containerObj&&(this.container=e.containerObj),e.adProperties?this.adProperties=e.adProperties:this.adProperties={},this.ifCommonAd=e.ifCommonAd,this.adsCallBack=t,this.loadScript()}showAd(i){return m(this,void 0,void 0,function*(){return new Promise((s,n)=>m(this,void 0,void 0,function*(){var e,t;try{null!==(e=this.adsCallBack)&&void 0!==e&&e.onShow(),this.ifCommonAd?yield this._addAdToContainer():yield this._addAdToSpecilContainer(i),null!==(t=this.adsCallBack)&&void 0!==t&&t.onSuccess(),this.adCloseCallback={},this.adCloseCallback.call=()=>{var e;s(),null!==(e=this.adsCallBack)&&void 0!==e&&e.onClose()}}catch(e){null!==(t=this.adsCallBack)&&void 0!==t&&t.onFail(),n({code:"show taboola ad error",message:e.message})}}))})}closeAd(){var e;return this.ifCommonAd&&this.currentContainerElement?(null!==(e=this.adCloseCallback)&&void 0!==e&&e.call(),this.currentContainerElement.remove(),Promise.resolve(!0)):!this.ifCommonAd&&this.currentSpecialContainerRootElement?(null!==(e=this.adCloseCallback)&&void 0!==e&&e.call(),this._removeSpecilContainer(),Promise.resolve(!0)):Promise.resolve(!1)}loadScript(){var e,t,s,n;pe.ifLoadScript||(window._taboola=window._taboola||[],_taboola.push({article:"auto"}),e=document.createElement("script"),t=document.getElementsByTagName("script")[0],s="//cdn.taboola.com/libtrc/minigame-network/loader.js",n="tb_loader_script",document.getElementById(n)||(e.async=1,e.src=s,e.id=n,t.parentNode.insertBefore(e,t)),window.performance&&"function"==typeof window.performance.mark&&window.performance.mark("tbl_ic"),pe.ifLoadScript=!0)}_setAttributesToElememt(e,t){if(e&&t)for(const n in e){var s;Object.hasOwnProperty.call(e,n)&&(s=e[n],t.setAttribute(n,s))}}_addAdToContainer(){try{const t=document.createElement("div");t.setAttribute("id",this.container.id),this.currentContainerElement=t,this._setAttributesToElememt(this.container.propertysObj,t);const s=document.querySelector(`${this.container.containerStr}`);if(s)if(this.currentContainerParentElement=s,this.container.ifInsertBefore){let e=null;s.hasChildNodes()&&(e=s.childNodes[0]),s.insertBefore(t,e)}else s.appendChild(t);return Promise.resolve(!0).then(e=>(this._setAd(),this._displayAd(),e))}catch(e){return console.error("show taboola ad is error",e),Promise.resolve(!1)}}_addAdToSpecilContainer(t){try{var e=`    
        <div style="overflow: hidden;width: 100vw;height: 100vh;background-color: #262626;">
            <div style="display: flex;justify-content: center;border: 1px solid transparent;border-radius: 4px;height: 8vh;background-color: #424242;line-height: 8vh;font-family: Google Sans, Roboto, Arial, sans-serif;font-size: 20px;color: #f5f5f5">
                Ad
                <div style="display: flex;position: absolute;right: 0;flex-direction: row;align-items: center;padding-right: 4%;height: inherit;cursor: pointer;">
                    <div>
                        <div id="closeAd" style="display: ${t.closeTime<0?"flex":"none"};align-items: center;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                <path style="fill: #f5f5f5"
                                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z">
                                </path>
                                <path fill="none" d="M0 0h24v24H0V0z"></path>
                            </svg>
                        </div>
                        <div id="autoSkidAd" style="display:${0<=t.closeTime?"block":"none"}; font-size: 12px">
                        Reward in <span id="autoSkidAdNum">${t.closeTime}</span> seconds
                        </div>
                    </div>
                </div>
            </div>
            <div id="specilContainerTaboolaAd" style="display: flex;flex-direction: column;justify-content: center;align-items: center;width: 100vw;height: 92vh;">

            </div>
        </div>
        `;const s=document.createElement("div");s.setAttribute("style","position: absolute;z-index:5;width:100%;height:100%"),s.innerHTML=e,ye.createDailogContainer().append(s),this.currentContainerParentElement=s.querySelector("#specilContainerTaboolaAd"),this.currentSpecialContainerRootElement=s;const n=document.createElement("div");n.setAttribute("id",this.container.id),this.currentContainerElement=n,this._setAttributesToElememt(this.container.propertysObj,n),this.currentContainerParentElement.appendChild(n);const i=s.querySelector("#closeAd"),r=s.querySelector("#autoSkidAd"),o=s.querySelector("#autoSkidAdNum");i.addEventListener("click",()=>{this.closeAd()});const a=e=>{o.innerText=e,e--,setTimeout(()=>{0<(o.innerText=e)?a(e):t.ifautoClose?this.closeAd():(i.style.display="flex",r.style.display="none")},1e3)};return a(t.closeTime),Promise.resolve(!0).then(e=>(this._setAd(),this._displayAd(),e))}catch(e){return console.error("show taboola ad is error",e),Promise.resolve(!1)}}_removeSpecilContainer(){ye.removeDailogContainer(()=>{this.currentSpecialContainerRootElement&&this.currentSpecialContainerRootElement.remove()})}_setAd(){window._taboola=window._taboola||[],window._taboola.push(Object.assign({target_type:"mix"},this.adProperties))}_displayAd(){window._taboola=window._taboola||[],window._taboola.push({flush:!0})}}pe.ifLoadScript=!1;class fe extends pe{constructor(e){e.ifCommonAd=!0,super(e)}showAd(){return super.showAd()}closeAd(){return super.closeAd()}}class Ae extends pe{constructor(e,t){e.taboolaParam.ifCommonAd=!1,e.closeInfo.closeTime=-1,super(e.taboolaParam,t),this.closeProperties=null,this.closeProperties=e.closeInfo}showAd(){return super.showAd(this.closeProperties)}closeAd(){return super.closeAd().then(e=>(this.closeProperties.closeBackFunc&&this.closeProperties.closeBackFunc instanceof Function&&this.closeProperties.closeBackFunc(),e))}}class we extends pe{constructor(e,t){e.taboolaParam.ifCommonAd=!1,super(e.taboolaParam,t),this.closeProperties=null,this.closeProperties=e.closeInfo}showAd(){return super.showAd(this.closeProperties)}closeAd(){return super.closeAd().then(e=>(this.closeProperties.closeBackFunc&&this.closeProperties.closeBackFunc instanceof Function&&this.closeProperties.closeBackFunc(),e))}}class ve extends me{constructor(){super(...arguments),this._curAd=null,this._strategyName="TaboolaStrategy"}loadAsync(){try{const e={taboolaParam:{containerObj:{id:"taboola-mobile-below-article-thumnbnails_interstitial",propertysObj:{style:"width: 340px;height:450px;overflow: hidden;margin: auto;background: white;"}},adProperties:{mode:"thumbnails-a1",container:"taboola-mobile-below-article-thumnbnails_interstitial",placement:"Mobile below article thumnbnails_Interstitial"+(this.getRewardedType()?`_${window.channelName}.rewarded`:`_${window.channelName}.interstitial`)},ifCommonAd:!1},closeInfo:{closeTime:5,ifautoClose:!1,closeBackFunc:()=>{}}};return this.getRewardedType()?(e.closeInfo.closeBackFunc=()=>{console.info("TaboolaRewardAd close")},this._curAd=new we(e,this.getAdsCallbackOption())):(e.closeInfo.closeBackFunc=()=>{console.info("TaboolaInterstitialAd close")},this._curAd=new Ae(e,this.getAdsCallbackOption())),Promise.resolve()}catch(e){return Promise.reject({code:`load ${this.getRewardedType()?"TaboolaRewardedVideoAd":"TaboolaInterstitialAd"} error`,message:e})}}showAsync(){return m(this,void 0,void 0,function*(){try{return yield this._curAd.showAd(),Promise.resolve()}catch(e){return Promise.reject({code:`show ${this.getRewardedType()?"TaboolaRewardedVideoAd":"TaboolaInterstitialAd"} error`,message:e})}})}isReady(){return!0}}class _e extends me{constructor(){super(...arguments),this._strategyName="AndroidStrategy",this._showAdsResult=null}loadAsync(){return new Promise((e,t)=>{e()})}showAsync(){return new Promise((t,s)=>{if(window.AdInteractive){if(this.getRewardedType()){var e=window.AdInteractive.isRewardedVideoAdReady();if(console.info("isRewardReady: ",e),!e)return console.info("android show Reward ads fail by not ready"),void s({code:"android show fail",message:"android show Reward ads fail by not ready"});window.AdInteractive.showRewardedVideoAd()}else{if(!window.AdInteractive.isInterstitialAdReady())return void s({code:"android show fail",message:"android show Inters ads fail by not ready"});window.AdInteractive.showInterstitialAd()}this._showAdsResult=e=>{e?t():s({code:"android show fail",message:"android show ads fail"})}}else s("Android AdInteractive not exist")})}isReady(){return!0}onShowAdsResult(e,t){console.info("====> android call back show success: ",e),this._showAdsResult?this._showAdsResult(e,t):console.info("====> android show ads result error")}}class be{constructor(e){this._isReward=!1,this._adInstants=[],this._curAdInstant=null,this._refreshTotalShowTimeCallback=null,this._isFinish=!1,this._isReward=e}get IsFinish(){return this._isFinish}set refreshTotalShowTimeCallback(e){this._refreshTotalShowTimeCallback=e}get refreshTotalShowTimeCallback(){return this._refreshTotalShowTimeCallback}getCurAdName(){return""}onShowAdsResult(e,t){var s;console.info(`onShowAdsResult: isSuccess: ${e}, errMessage: ${t}, this._curAdInstant: ${this._curAdInstant}`),this._curAdInstant&&null!==(s=this._curAdInstant)&&void 0!==s&&s.onShowAdsResult(e,t)}}(Ut=c=c||{})[Ut.AdTypeEnumNull=0]="AdTypeEnumNull",Ut[Ut.Display=1]="Display",Ut[Ut.Float=2]="Float",Ut[Ut.Banner=3]="Banner",Ut[Ut.Interstitial=4]="Interstitial",Ut[Ut.Rewarded=5]="Rewarded";class Pe{constructor(){this._mdaInfos=[]}static get instance(){return this._instance||(this._instance=new Pe),this._instance}fetchMdaData(n){return m(this,void 0,void 0,function*(){try{if(1<this._mdaInfos.length){var e=this._mdaInfos.shift();return Promise.resolve(e)}var t=yield k(`${j.DOMAIN}${j.BATCH_API_PATH}`,{batch:[{adType:n,count:3}]});if(console.info("====> MDA Info: ",t),200!==t.code)return Promise.reject({code:"REQUEST_MDA_ERROR",message:t.message});this._mdaInfos=this._mdaInfos.concat(t.data.ads);var s=this._mdaInfos.shift();return Promise.resolve(s)}catch(e){return Promise.reject({code:"FETCH_MDS_ERROR",message:e.message})}})}}Pe._instance=null;const Se=Pe.instance,Ie={interstitial:1,rewardedVideo:2,banner:3},Te={close:"close",adLoaded:"finish",adLoadError:"loadError",click:"click"};class Re{constructor(e,t,s){this.adid=e.id,this.adType=e.type,this.adTargetUrl=e.target_url,this.adMaterial=e.material_url,this.adTemplateUrl=e.template_url,this.adShowAttributeUrl=e.show_attribute_url,this.playLimitTime=e.impression,this.iframe=null,this.adTargetObj=null,this.isInit=!1,this.timeStamp=(new Date).getTime().toString(),this.gaId=t,this.cbOptions=s}getIframe(){return this.iframe}getGaId(){return this.gaId}getAdType(){return this.adType}getAdTargetUrl(){return this.adTargetUrl}getAdMaterial(){return this.adMaterial}getAdTemplateUrl(){return this.adTemplateUrl}getTimeStamp(){return this.timeStamp}getAdId(){return this.adid}getInit(){return this.isInit}getPlayLimitTime(){return this.playLimitTime}getShowAttributeUrl(){return this.adShowAttributeUrl}onShow(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onShow()}onSuccess(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onSuccess()}onFail(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onFail()}onClose(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onClose()}onClick(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onClick()}createIframe(){return new Promise((e,t)=>{const s=window.document.createElement("iframe");s.setAttribute("style","overflow: hidden !important; width: 100vw !important; height: 100vh !important; top:0 !important; right:0 !important; bottom:0 !important; left:0 !important; position: fixed !important; clear: none !important; display: none !important; float: none !important; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1 !important; padding: 0px !important; vertical-align: baseline !important; visibility: visible !important; z-index: 1000000000 !important;"),s.setAttribute("src",this.adTemplateUrl),s.setAttribute("id","minigameiframe"),s.setAttribute("marginwidth","0"),s.setAttribute("frameborder","0"),s.setAttribute("marginheight","0"),s.setAttribute("scrolling","no"),window.document.querySelector("html").appendChild(s),s.onload=function(){console.info("iframe loaded"),e(s)},s.onerror=function(e){console.error("fail to load iframe: ",e),t(new Error(e.toString()))}})}showIframe(){this.iframe.setAttribute("style","overflow: hidden !important; width: 100vw !important; height: 100vh !important; top:0 !important; right:0 !important; bottom:0 !important; left:0 !important; position: fixed !important; clear: none !important; display: inline !important; float: none !important; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1 !important; padding: 0px !important; vertical-align: baseline !important; visibility: visible !important; z-index: 1000000000 !important;")}removeIframe(){this.isInit&&this.iframe.remove(),this.isInit=!1}initAsync(){return m(this,void 0,void 0,function*(){try{if(this.iframe=yield this.createIframe(),null===this.iframe)throw console.warn("fail to create iframe"),{code:"NO_IFRAME",msg:"fail to create iframe"};switch(this.adType){case Ie.interstitial:case Ie.rewardedVideo:this.adTargetObj=new Ce(this);break;case Ie.banner:throw{code:"NO_BANNER",msg:"feature is under development"}}var e={adTargetUrl:this.adTargetUrl,adMaterial:this.adMaterial,timeStamp:this.timeStamp,adId:this.adid,gaId:this.gaId,showAd:!1};return this.adTargetObj.loadAd(e,this.iframe),window.removeEventListener("message",this.receiveMessageFromIframePage.bind(this),!1),window.addEventListener("message",this.receiveMessageFromIframePage.bind(this),!1),this.isInit=!0,this.adTargetObj}catch(e){throw console.error("fail to init minigame ads: ",e),new Error(e.toString())}})}receiveMessageFromIframePage(e){if(e.data&&(e.data.action&&this.timeStamp===e.data.timeStamp&&(console.info("receive message from iframe: ",e),this.isInit)))switch(e.data.action){case Te.close:this.adTargetObj.closeAd(),this.onClose();break;case Te.adLoaded:this.adTargetObj.ready=!0;break;case Te.adLoadError:this.adTargetObj.ready=!1;break;case Te.click:this.onClick()}}}class Ce extends class{constructor(e){this.adCloseEvent=null,this.adLoadedEvent=null,this.adIframe=e}set ready(e){var t;this.isReady=e,null!==(t=this.adLoadedEvent)&&void 0!==t&&t.call(e)}get ready(){return this.isReady}loadAd(e,t){this.timeStamp=e.timeStamp,console.info("send message to iframe: ",e),t.contentWindow.postMessage(e,"*")}showAd(){return new Promise((e,t)=>{let s=!1;return this.adIframe.getInit()&&(this.adIframe.showIframe(),s=!0),s})}closeAd(){let e=!1;return this.adIframe.getInit()&&(this.adIframe.removeIframe(),e=!0),e}getAdId(){return this.adIframe.getAdId()}getPlayLimitTime(){return this.adIframe.getPlayLimitTime()}}{constructor(e){super(e),this.ready=!1}showAd(){return new Promise((e,t)=>{try{this.adIframe.onShow(),this.adCloseEvent={},this.adCloseEvent.call=()=>{e()};const s={adTargetUrl:this.adIframe.getAdTargetUrl(),adShowAttributeUrl:this.adIframe.getShowAttributeUrl(),adMaterial:this.adIframe.getAdMaterial(),timeStamp:this.adIframe.getTimeStamp(),gaId:this.adIframe.getGaId(),adId:this.adIframe.getAdId(),adType:this.adIframe.getAdType(),showAd:!0};super.showAd()&&this.ready?(this.adIframe.getIframe().contentWindow.postMessage(s,"*"),this.adIframe.onSuccess()):(this.adLoadedEvent={},this.adLoadedEvent.call=e=>{e?(this.adIframe.getIframe().contentWindow.postMessage(s,"*"),this.adIframe.onSuccess()):(this.adIframe.onFail(),t({code:"not ready",msg:"fail to show ad due to not ready"}))})}catch(e){console.error(e),t({code:"not ready",msg:"fail to show ad due to not ready:"+e}),this.adIframe.onFail()}})}closeAd(){var e;let t=!1;try{super.closeAd()&&(t=!0,null!==(e=this.adCloseEvent)&&void 0!==e&&e.call())}catch(e){console.error(e)}return t}}window.createAdIframe=function(t,s,n){return m(this,void 0,void 0,function*(){try{const e=new Re(t,s,n);return yield e.initAsync()}catch(e){throw{code:"load_ad_error",message:"load ad error: "+e.message}}})};class xe extends me{constructor(){super(...arguments),this._curAd=null,this._strategyName="MdaStrategy",this._isStartLoad=!1,this._isLoaded=!1,this._loadedCallback=null}loadAsync(){return m(this,void 0,void 0,function*(){try{const t=1,s=2;var e=yield Se.fetchMdaData(this.getRewardedType()?c.Rewarded:c.Interstitial);const n={};n.id=e.id,n.type=this.getRewardedType()?s:t,n.template_url=e.template_url,n.material_url=e.material.url,n.target_url=e.target_url,n.show_attribute_url=e.show_attribute_url,n.support_country=[],n.support_language=[],n.impression=0;const i=new Re(n,"",this.getAdsCallbackOption());return console.info("====> MDA start load"),this._isStartLoad=!0,this._curAd=yield i.initAsync(),this._isLoaded=!0,this._loadedCallback&&this._loadedCallback(this._isLoaded),console.info("====> MDA load success"),Promise.resolve()}catch(e){return console.info("====> MDA load error: ",e),Promise.reject({code:"MDA_LOAD_ERROR",message:e.message})}})}setEventCallback(){this.setAdsCallback({onShow:()=>{console.log(" =======> MDA show")},onSuccess:()=>{console.log(" =======> MDA success")},onFail:()=>{console.log(" =======> MDA failed")},onClick:()=>{console.log(" =======> MDA clicked")},onClose:()=>{console.log(" =======> MDA closed")}})}showAsync(){return m(this,void 0,void 0,function*(){if(!this._isLoaded&&this._isStartLoad)return new Promise((t,s)=>{this._loadedCallback=e=>m(this,void 0,void 0,function*(){e?this._curAd?(yield this._curAd.showAd(),console.info("====> MDA show success"),t()):s({code:"NO_ADS",message:"[MDA] no ads"}):s({code:"MDA_SHOW_ERROR",message:"MDA load fail"})})});try{return this._curAd?(yield this._curAd.showAd(),console.info("====> MDA show success"),Promise.resolve()):Promise.reject({code:"NO_ADS",message:"[MDA] no ads"})}catch(e){return console.info("====> MDA show error: ",e),Promise.reject({code:"MDA_SHOW_ERROR",message:e.message})}})}isReady(){return this._curAd&&this._curAd.ready}}class ke extends be{constructor(e,t,s){super(e),this._config=null,this._next=null,this._curSucTimes=0,this._curAdName="",this._config=t,this._next=s}loadAsync(s){return m(this,void 0,void 0,function*(){try{if(this._curSucTimes<this._config.showTimes||-1===this._config.showTimes){const e={adsense:ge,taboola:ve,android:_e,mda:xe}[this._config.adsName];if(void 0===e)return this._isFinish=!0,this._next&&this._next(),console.info(`======> error: ${this._config.adsName} waterfall strategy not found, exec queue next`),Promise.reject({code:O.ADS_NETWORK_NOT_FOUND,message:`${this._config.adsName} waterfall strategy not found`});const t=new e(s,this._isReward);return t.setAdsCallback({onShow:()=>{console.log(`====> ${this._curAdName} show`)},onSuccess:()=>{console.log(`====> ${this._curAdName} success`),this._curSucTimes++,this._curSucTimes===this._config.showTimes&&(this._isFinish=!0,this._next&&this._next()),this._refreshTotalShowTimeCallback&&this._refreshTotalShowTimeCallback()},onFail:()=>{console.log(`====> ${this._curAdName} failed`)},onClick:()=>{console.log(`====> ${this._curAdName} clicked`)},onClose:()=>{console.log(`====> ${this._curAdName} closed`)}}),yield t.loadAsync(),this._adInstants.push(t),Promise.resolve()}return Promise.reject({code:"load waterFall ad error",message:"has reach showTimes"})}catch(e){return Promise.reject({code:"load waterFall ad error",message:e.message})}})}showAsync(){return m(this,void 0,void 0,function*(){try{if(this._adInstants.length<=0)return Promise.reject({code:"show adInstant error",message:"there is no ad instant"});if(this._curSucTimes<this._config.showTimes||-1===this._config.showTimes){const e=this._adInstants.shift();return this._curAdName=e.getStrategyName(),this._curAdInstant=e,yield e.showAsync(),Promise.resolve()}}catch(e){return Promise.reject(e)}})}getCurAdName(){return this._curAdName=this._adInstants[0].getStrategyName(),this._curAdName}}class De extends be{constructor(e,t){super(e),this.adsNames=[],this.curAdName="",this.adsNames=this.adsNames.concat(t)}loadAsync(a){return m(this,void 0,void 0,function*(){try{var e={adsense:ge,taboola:ve,android:_e,mda:xe},t=Math.floor(Math.random()*this.adsNames.length);const n=e[this.adsNames[t]];var s={onShow:()=>{console.log(`====> ${this.curAdName} show`)},onSuccess:()=>{console.log(`====> ${this.curAdName} success`),this._refreshTotalShowTimeCallback&&this._refreshTotalShowTimeCallback()},onFail:()=>{console.log(`====> ${this.curAdName} failed`)},onClick:()=>{console.log(`====> ${this.curAdName} clicked`)},onClose:()=>{console.log(`====> ${this.curAdName} closed`)}};if(this._adInstants.length<=0){const i=new n(a,this._isReward);this._adInstants.push(i),i.setAdsCallback(s),yield i.loadAsync();const r=new n(a,this._isReward);this._adInstants.push(r),r.setAdsCallback(s),yield r.loadAsync()}else{const o=new n(a,this._isReward);this._adInstants.push(o),o.setAdsCallback(s),yield o.loadAsync()}return Promise.resolve()}catch(e){return Promise.reject({code:"load keep bottom ad error",message:e.message})}})}showAsync(){try{const e=this._adInstants.shift();return this.curAdName=e.getStrategyName(),this._curAdInstant=e,e.showAsync()}catch(e){return Promise.reject({code:"Keep_Bottom_ad_show_error",message:e.message})}}getCurAdName(){return this.curAdName=this._adInstants[0].getStrategyName(),this.curAdName}}class Ee extends be{constructor(e,t){super(e),this.adsNames=[],this.adsNames=this.adsNames.concat(t)}loadAsync(o){return m(this,void 0,void 0,function*(){if(0===this.adsNames.length)return console.info("====> No Substitute Ads's config"),Promise.resolve();try{var t={adsense:ge,taboola:ve,android:_e,mda:xe};const n={AfgStrategy:"adsense",TaboolaStrategy:"taboola",AndroidStrategy:"android",MdaStrategy:"mda"};for(let e=0;e<this.adsNames.length;e++){const i=this.adsNames[e];if(!this._adInstants.some((e,t,s)=>{e=e.getStrategyName();return n[e]===i})){const s=t[i],r=new s(o,this._isReward);this._adInstants.push(r),yield r.loadAsync()}}return Promise.resolve()}catch(e){return console.info("====> load substitute ad error: ",e.message),Promise.resolve()}})}showAsync(t){if(0===this.adsNames.length)return console.info("====> No Substitute Ads's config"),Promise.reject({code:"AdsSubstitute show error",message:"No Substitute Ads's config"});try{const s=this._adInstants.find(e=>e.getStrategyName()!==t);if(!s)return Promise.reject({code:"AdsSubstitute show error",message:`${t} is the same with substitute ad`});this._curAdInstant=s;var e=this._adInstants.indexOf(s);this._adInstants.splice(e,1);const n=s.getStrategyName();return s.setAdsCallback({onShow:()=>{console.log(`====> ${n} success`)},onSuccess:()=>{console.log(`====> ${n} success`),this._refreshTotalShowTimeCallback&&this._refreshTotalShowTimeCallback()},onFail:()=>{console.log(`====> ${n} failed`)},onClick:()=>{console.log(`====> ${n} clicked`)},onClose:()=>{console.log(`====> ${n} closed`)}}),s.showAsync()}catch(e){return Promise.reject(e)}}}(Ft=d=d||{}).waterFall="waterFall",Ft.keepBottom="keepBottom",(Wt=Lt=Lt||{}).adsense="AfgStrategy",Wt.taboola="TaboolaStrategy",Wt.android="AndroidStrategy";class Oe{constructor(e,t){this.config=null,this.isReward=!1,this.lastShowTime=0,this.enabled=!0,this.limitTime=0,this.adsWaterFall=[],this.adsKeepBottom=null,this.adsSubstitute=null,this.queue=null,this.adState=d.waterFall,this.curAds=null,this.curShowTimes=0,this.placementID="",this.isReward=e,this.config=t,this.enabled=this.config.enabled,this.limitTime=this.config.limitTime,this.adsKeepBottom=new De(this.isReward,this.config.strategy.keepBottom),this.adsSubstitute=new Ee(this.isReward,this.config.strategy.substitute),this.queue=new he,this.pushToQueue(),this.onComplete(),this.queue.play()}pushToQueue(){const e=this.config.strategy.waterFall;e.forEach((n,e,t)=>{this.queue.push((t,e,s)=>m(this,void 0,void 0,function*(){const e=new ke(this.isReward,n,t);this.adsWaterFall.push(e),e.refreshTotalShowTimeCallback=()=>{this.lastShowTime=C.getTimeBySecond(),this.curShowTimes++}}))})}onComplete(){this.queue.complete=()=>m(this,void 0,void 0,function*(){this.adState=d.keepBottom,console.info("====> waterFall ads finish."),yield this.adsKeepBottom.loadAsync(this.placementID),console.info("====> preload keepBottom ads")})}loadAsync(s){return m(this,void 0,void 0,function*(){if(0===this.placementID.length&&(this.placementID=s),!this.enabled)return Promise.reject({code:`load ${this.isReward?"rewardAd":"interstitialAd"} error`,message:`${this.isReward?"rewardAd":"interstitialAd"} is disabled`});try{if(yield this.adsSubstitute.loadAsync(s),this.adState!==d.waterFall)return this.adState===d.keepBottom?this.adsKeepBottom.loadAsync(s):Promise.reject({code:"Ads load  error",message:"ad state error"});{const e=this.adsWaterFall.find(e=>!1===e.IsFinish);return e.loadAsync(s)}}catch(e){if(e.code!==O.ADS_NETWORK_NOT_FOUND)return Promise.reject({code:`${this.adState} load ad error`,message:e.message});if(this.adState!==d.waterFall)return this.adState===d.keepBottom?this.adsKeepBottom.loadAsync(s):Promise.reject({code:"Ads load  error",message:"ad state error"});{const t=this.adsWaterFall.find(e=>!1===e.IsFinish);return t.loadAsync(s)}}})}showAsync(){return m(this,void 0,void 0,function*(){if(!this.enabled)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} error`,message:`${this.isReward?"rewardAd":"interstitialAd"} is unable`});if(this.curShowTimes>=this.config.totalTimes&&-1!==this.config.totalTimes)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} error`,message:"had reach the max show times"});var e=C.getTimeBySecond()-this.lastShowTime;if(e<this.limitTime)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} frequently`,message:`${this.limitTime-e} seconds remain`});let t="";try{if(this.adState!==d.waterFall)return this.adState===d.keepBottom?(t=this.adsKeepBottom.getCurAdName(),this.curAds=this.adsKeepBottom,yield this.adsKeepBottom.showAsync(),this.lastShowTime=C.getTimeBySecond(),this.curShowTimes++,Promise.resolve()):Promise.reject({code:"load ad error",message:"ad state error"});{const s=this.adsWaterFall.find(e=>!1===e.IsFinish);return t=s.getCurAdName(),this.curAds=s,yield s.showAsync(),Promise.resolve()}}catch(e){if("dismissed"===e.code)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} error`,message:e.message});this.curAds=this.adsSubstitute;try{return yield this.adsSubstitute.showAsync(t),this.curShowTimes++,Promise.resolve()}catch(e){return Promise.reject(e)}}})}onShowAdsResult(e,t){console.info(`====> ${this.isReward?"rewardAd":"interstitialAd"} show result: ${e}, this.curAds: ${this.curAds}`),this.curAds?this.curAds.onShowAdsResult(e,t):console.error("adsController onShowAdsResult error: cur ads is null")}}class je{}class Ne extends je{constructor(){super(...arguments),this._showBannerResult=null,this._hideBannerResult=null}showBannerAsync(e){return new Promise((t,s)=>{window.AdInteractive?(window.AdInteractive.showBannerAd(),this._showBannerResult=e=>{e?t():s({code:"android show fail",message:"android show banner ads fail"})}):s("Android AdInteractive not exist")})}hideBannerAsync(){return new Promise((t,s)=>{window.AdInteractive?(window.AdInteractive.hideBannerAd(),this._hideBannerResult=e=>{e?t():s({code:"android hide fail",message:"android hide banner ads fail"})}):s("Android AdInteractive not exist")})}onShowBannerResult(e){this._showBannerResult?this._showBannerResult(e):console.error("android show banner result error")}onHideBannerResult(e){this._hideBannerResult?this._hideBannerResult(e):console.error("android hide banner result error")}}class Be extends je{constructor(){super(...arguments),this._bannerElement="minigameTaboolaBanner"}showBannerAsync(e){try{const s=document.createElement("div");s.setAttribute("id","minigameTaboolaBanner"),s.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;bottom:0;  z-index: 19999; overflow: hidden; width: 100vw;height: 80px; background-color: black;display: flex;align-items: end;justify-content: center;"),document.body.append(s);var t={containerObj:{id:"taboola-below-article-thumbnails_stream",containerStr:`#${this._bannerElement}`,ifInsertBefore:!1,propertysObj:{style:"width:320px;height:70px;overflow: hidden;background: #fff;"}},adProperties:{mode:"thumbnails-stream",container:"taboola-below-article-thumbnails_stream",placement:`Below Article Thumbnails_Stream_${window.channelName}.game.banner`}};const n=new fe(t);return n.showAd()}catch(e){return Promise.reject({code:"show tabool banner error",message:e.message})}}hideBannerAsync(){const e=document.getElementById(this._bannerElement);return e&&e.remove(),Promise.resolve()}}class qe{constructor(e){this._config=null,this._curBannerAd=null,this.curShowTimes=0,this._config=e}showBannerAsync(s){return m(this,void 0,void 0,function*(){if(!this._config.enabled)return Promise.reject({code:"show banner error",message:"banner is disabled"});if(this.curShowTimes>=this._config.totalTimes&&-1!==this._config.totalTimes)return Promise.reject({code:"show banner error",message:"banner show times is over"});try{const e={taboola:Be,android:Ne}[this._config.adsName],t=new e;return this._curBannerAd=t,yield t.showBannerAsync(s),this.curShowTimes++,Promise.resolve()}catch(e){return Promise.reject(e)}})}hideBannerAsync(){return this._config.enabled?this._curBannerAd.hideBannerAsync():Promise.reject({code:"hide banner error",message:"banner is disabled"})}onShowBannerResult(e,t){var s;this._curBannerAd?null!==(s=this._curBannerAd)&&void 0!==s&&s.onShowBannerResult(e,t):console.error("ShowBanner Android Callback Error: cur bannnerAd is null")}onHideBannerResult(e,t){var s;this._curBannerAd?null!==(s=this._curBannerAd)&&void 0!==s&&s.onHideBannerResult(e,t):console.error("HideBanner Android Callback Error: cur bannnerAd is null")}}class $e{constructor(){this._config=null}get config(){return this._config}static get instance(){return this._instance||(this._instance=new $e),this._instance}fetchConfigAsync(s){return m(this,void 0,void 0,function*(){try{var e=s;const t=yield fetch(e);return 404===t.status?Promise.reject({code:"No_Config_File",message:"there is no config file "+e}):(this._config=yield t.json(),console.info("fetch MinigameAd config success: ",this._config),Promise.resolve())}catch(e){return Promise.reject({code:"fetch MinigameAd fail",message:e.message})}})}}$e._instance=null;const Me=$e.instance,Ue={adType:{interstitial:{enabled:!0,limitTime:30,totalTimes:-1,strategy:{waterFall:[{adsName:"adsense",showTimes:-1}],keepBottom:[],substitute:[]}},reward:{enabled:!0,limitTime:0,totalTimes:-1,strategy:{waterFall:[{adsName:"adsense",showTimes:-1}],keepBottom:[],substitute:[]}},banner:{enabled:!1,adsName:"taboola",totalTimes:3}}};class Fe{constructor(){this.interstitialAdsController=null,this.rewardAdsController=null,this.bannerAdsController=null,this.config=null}static get instance(){return this._instance||(this._instance=new Fe),this._instance}createAdInstants(){this.config=Me.config||Ue,this.rewardAdsController=new Oe(!0,this.config.adType.reward),this.interstitialAdsController=new Oe(!1,this.config.adType.interstitial),this.bannerAdsController=new qe(this.config.adType.banner)}loadAsync(e,t){return console.info("====> load AD placementId: ",e,"isReward: ",t),(t?this.rewardAdsController:this.interstitialAdsController).loadAsync(e)}showAsync(e){return console.info("====> show AD isReward: ",e),(e?this.rewardAdsController:this.interstitialAdsController).showAsync()}loadBannerAsync(e){return this.bannerAdsController.showBannerAsync(e)}hideBannerAsync(){return this.bannerAdsController.hideBannerAsync()}showPrerollAsync(){return S.isH5AndroidApp()?this.interstitialAdsController.showAsync():ue(Z.preroll,"preroll",void 0)}onShowAdsResult(e,t,s){console.info(`=====> androidCallJs onShowAdsResult isReward: ${e}, isSuccess: ${t}, message: ${s}`),(e?this.rewardAdsController:this.interstitialAdsController).onShowAdsResult(t,s)}onShowBannerResult(e,t){console.info(`=====> androidCallJs onShowBannerResult isSuccess: ${e}, errMessage: ${t}`),this.bannerAdsController.onShowBannerResult(e,t)}onHideBannerResult(e,t){console.info(`=====> androidCallJs onHideBannerResult isSuccess: ${e}, errMessage: ${t}`),this.bannerAdsController.onHideBannerResult(e,t)}}Fe._instance=null;const Le=Fe.instance;window.showProllAsync=Le.showPrerollAsync.bind(Le),window.onShowAdsResult=Le.onShowAdsResult.bind(Le),window.onShowBannerResult=Le.onShowBannerResult.bind(Le),window.onHideBannerResult=Le.onHideBannerResult.bind(Le);const We=class Jt{constructor(){this._ads=[],this._curAd=null,this._curBannerAd=null}get curAd(){return this._curAd}static get instance(){return this._instance||(this._instance=new Jt),this._instance}loadAsync(t,s){return m(this,void 0,void 0,function*(){try{const e=new _e(t,s);return this._ads.push(e),e.loadAsync()}catch(e){return Promise.reject(e)}})}showAsync(t){try{const e=this._ads.find(e=>e.getRewardedType()===t);return this._curAd=e,console.info("====> showAsync: ad ing"),e.showAsync()}catch(e){return console.info("====> showAsync error: ",e.message),Promise.reject(e)}}loadBannerAdAsync(e){try{const t=new Ne;return this._curBannerAd=t,t.showBannerAsync(e)}catch(e){return Promise.reject(e)}}hideBannerAdAsync(){try{return this._curBannerAd.hideBannerAsync()}catch(e){return Promise.reject(e)}}onShowBannerResult(e,t){this._curBannerAd.onShowBannerResult(e)}onHideBannerResult(e,t){this._curBannerAd.onHideBannerResult(e)}onShowAdsResult(e,t){console.info(`====> onShowAdsResult: isSuccess = ${e}, errMessage = ${t}`);try{this._curAd.onShowAdsResult(e,t)}catch(e){console.info("====> onShowAdsResult error: ",e.message),console.error("====> onShowAdsResult error: ",e.message)}}}.instance;window.onShowAdsResult=We.onShowAdsResult.bind(We),window.onShowBannerResult=We.onShowBannerResult.bind(We),window.onHideBannerResult=We.onHideBannerResult.bind(We),Le.onShowAdsResult=We.onShowAdsResult.bind(We),Le.onShowBannerResult=We.onShowBannerResult.bind(We),Le.onHideBannerResult=We.onHideBannerResult.bind(We);class Ge{constructor(e,t,s){this.type=e,this.isOneWay=t,this._serviceHandler=s}onRequest(e){return m(this,void 0,void 0,function*(){return this._serviceHandler?this._serviceHandler(e):Promise.resolve(Ke(e))})}}function ze(e){return`${e}_RESPONSE`}function He(e,t,s,n){return{type:ze(e.type),requestType:e.type,requestId:e.requestId,code:t,message:s,payload:n}}function Ke(e,t){return He(e,g.OK.code,g.OK.message,t)}function Ve(e,t,s,n){return He(e,t,s,n)}class Ye{constructor(e){this._window=e,this._messageDispatcher=this._onReceiveMessage.bind(this)}_onReceiveMessage(e){try{var t=e.data;t&&t.type&&this.dispatch(t,e.source)}catch(e){console.error("Error in receiveMessage: ",e)}}static postMessageTo(e,t,s="*"){e.postMessage(t,s)}start(){this._window.addEventListener("message",this._messageDispatcher,!1)}stop(){this._window.removeEventListener("message",this._messageDispatcher,!1)}}class Je extends Ye{constructor(e,t){super(e),this._requestCounter=0,this._pendingRequests=[],this._requestWindow=t}static createDefaultInstance(e){return this._instance||(this._instance=new Je(window,e)),this._instance}static get instance(){if(!this._instance)throw{code:"NO_CLIENT_INSTANCE",message:"MediationClient is not initialized"};return this._instance}dispatch(e,t){const s=e,n=this._pendingRequests.find(e=>e.responseType===s.type&&e.requestId===s.requestId);n&&(this._pendingRequests=this._pendingRequests.filter(e=>!(e.responseType===s.type&&e.requestId===s.requestId)),n.onResponse&&n.onResponse(s))}invokeServiceAsync(t,i=!1){return new Promise((s,n)=>{var e;t.requestId=++this._requestCounter,i||(e={responseType:t.responseType||ze(t.type),requestType:t.type,requestId:t.requestId,onResponse:e=>{var t;((t=e).code===l.OK||void 0===t.code||null===t.code||""===t.code?s:n)(e)}},this._pendingRequests.push(e)),Ye.postMessageTo(this._requestWindow,t,"*")})}invokeQuickServiceAsync(e,t=!1,s){return this.invokeServiceAsync({type:e,payload:s},t)}}(zt=Gt=Gt||{}).adsense="adsense",zt.m150ad="m150ad",zt.android="android";class Qe{constructor(){this._adsDataFile=""}static createDefaultInstance(){return this._instance||(this._instance=new Qe),this._instance}static get instance(){return this._instance||(this._instance=new Qe),this._instance}get strategy(){return this._adsStrategyOption}get adsShowOption(){return this._adsShowOption}fetchConfigAsync(n){return m(this,void 0,void 0,function*(){try{var e=n;const s=yield fetch(e);if(404===s.status)throw{code:"No_Config_File",message:"there is no config file "+e};var t=yield s.json();return this._adsStrategyOption=t.ad_configs,console.info("fetchAdsStrategyConfig success: ",this._adsStrategyOption),Promise.resolve()}catch(e){return Promise.reject({message:"fetchAdsConfig error: "+e.message})}})}fetchAdsData(s){return m(this,void 0,void 0,function*(){try{var e=!!(s&&0<s.length);e||console.warn("fetchAdsData error: url is null"),this._adsDataFile=e?s:"/data.json";const t=yield fetch(this._adsDataFile);return this._adsShowOption=yield t.json(),console.info("fetchAdsData success: ",this._adsShowOption),Promise.resolve()}catch(e){return Promise.reject({code:"No_Ads_Data",message:"load ads data file: "+e.message})}})}fetchShowConfigAsync(e){return m(this,void 0,void 0,function*(){try{if(this._adsShowOption)return Promise.resolve(this._adsShowOption);let e=this._adsDataFile||"/data.json";window.MiniGameAds&&window.MiniGameAds.isTest&&(e="/data.json");const t=yield fetch(e);return this._adsShowOption=yield t.json(),console.info("fetchAdsShowConfig success: ",this._adsShowOption),Promise.resolve(this._adsShowOption)}catch(e){throw console.error("fetchShowConfig error: ",e),{code:"Fetch_Ads_Data_Error",message:"data file was "+e.message}}})}isPlatformOpen(t){var e=this.strategy.platforms.find(e=>e.id===t);return!!e&&e.enabled}}Qe.instance;const Ze="minigameTaboolaBanner";class Xe{constructor(){this._ads=[]}static get instance(){return this._instance||(this._instance=new Xe),this._instance}loadAsync(e){return this._ads.push(e),e.loadAsync()}showAsync(){return new Promise((t,s)=>{for(let e=0;e<this._ads.length;e++)if(this._ads[e].isReady())return void this._ads[e].showAsync().then(()=>{t(),this._ads.splice(e,1)}).catch(e=>{s(e)});s("===>test ads not ready")})}showBannerAsync(e){const t=document.createElement("div");t.setAttribute("id","minigameTaboolaBanner"),t.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;bottom:0;  z-index: 19999; overflow: hidden; width: 100vw;height: 80px; background-color: black;display: flex;align-items: end;justify-content: center;"),document.body.append(t);var s={containerObj:{id:"taboola-below-article-thumbnails_stream",containerStr:`#${Ze}`,ifInsertBefore:!1,propertysObj:{style:"width:320px;height:70px;overflow: hidden;background: #fff;"}},adProperties:{mode:"thumbnails-stream",container:"taboola-below-article-thumbnails_stream",placement:"Below Article Thumbnails_Stream_localTest.game.banner"}};const n=new fe(s);return n.showAd()}hideBannerAsync(){const e=document.getElementById(Ze);return e&&e.remove(),Promise.resolve()}}let et=Xe.instance;class tt{static set(e,t){"object"==typeof t?localStorage.setItem(e,JSON.stringify(t)):localStorage.setItem(e,t)}static get(t,e=!0){t=localStorage.getItem(t);if(t){if(e)try{return JSON.parse(t)}catch(e){return t}return t}return null}static remove(e){localStorage.removeItem(e)}static clear(){localStorage.clear()}}const st="show_ads_count",nt="shortcut_last_show_time_",it="game_id_",rt="shortcut_show_count_";const ot=class Qt{static get instance(){return this._instance||(this._instance=new Qt),this._instance}setAdsShowCount(t,e){var s=C.getDate(),n=this.getAdsShowCount(t);if(n<e){n++;let e=tt.get(st,!0);if(null==e){const i={};i[""+t]=n,e={},e[s]=i}else e[s][t+""]=n;tt.set(st,e)}}getAdsShowCount(e){var t=C.getDate();const s=tt.get(st,!0);if(null==s)return 0;if(null!=s[t])return null==s[t][e+""]?(s[t][e+""]=0,tt.set(st,s),0):s[t][e+""];{tt.remove(st);const n={},i={};return i[""+e]=0,n[t]=i,tt.set(st,n),0}}setInterstitialAdsShowCount(e){var t=C.getDate();const s=this.getInterstitialAdsShowCount(e);var n=s[rt+t];n<2&&(n++,s[rt+t]=n,tt.set(it+e,s),this.setLastPlayInterstitialTime(e))}getInterstitialAdsShowCount(e){var t=C.getDate(),s=tt.get(it+e,!0);if(null==s){const n={};return n[rt+t]=0,tt.set(it+e,n),n}if(null!=s[rt+t])return s;{tt.remove(it+e),tt.remove(nt+e);const i={};return i[rt+t]=0,tt.set(it+e,i),i}}setLastPlayInterstitialTime(e){tt.set(nt+e,C.getTimestamp())}getLastPlayInterstitialTime(e){return null==(e=tt.get(nt+e,!0))?0:e}}.instance;class at extends me{constructor(){super(...arguments),this._curAd=null,this._strategyName="M150adStrategy"}loadAsync(){return Qe.instance.fetchShowConfigAsync().then(r=>m(this,void 0,void 0,function*(){if("undefined"==typeof createAdIframe)return Promise.reject({code:"Fetch_Ads_Data_Error",message:"data file was failded to load"});const t={interstitial:1,rewarded:2,preroll:1}[this.getType()],e=r.ads.filter(e=>e.type===t);if(console.info("[MiniGame Ads] suitTypeAds: ",e),0===e.length)return Promise.reject({code:"Error_Type_Ads_No_Suit_Type",message:`there is no suit type ads for ${this.getType()}|${t}`});const i=[];if(e.forEach(e=>{const t=navigator.language,s=t.toLocaleLowerCase();let n=e.support_language;0===n.length&&i.push(e),n=n.filter(e=>{const t=e.toLocaleLowerCase();return-1!==t.indexOf(s)}),0<n.length&&i.push(e)}),console.info("[MiniGame Ads] suitLanguageAds: ",i),0===i.length)return Promise.reject({code:"Error_Type_Ads_No_Suit_Region",message:`there is no region type ads for ${navigator.language}`});const s=[];if(i.forEach(e=>{ot.getAdsShowCount(e.id)<e.impression&&s.push(e)}),console.info("[MiniGame Ads] suitPlayTimesAds: ",s),0===s.length)return Promise.reject({code:"Error_Type_Ads_Limit_Times",message:`play times reach limit ${this.getType()}|${t}`});var n=Math.floor(Math.random()*s.length);return this._curAd=yield createAdIframe(s[n],r.ga_config.id,this.getAdsCallbackOption()),Promise.resolve()})).catch(e=>Promise.reject(e))}showAsync(){return m(this,void 0,void 0,function*(){try{return this._curAd?(yield this._curAd.showAd(),console.info("[MiniGame Ads] success to show ad"),ot.setAdsShowCount(this._curAd.getAdId(),this._curAd.getPlayLimitTime()),Promise.resolve()):Promise.reject({code:"no ads",message:"[M150adStrategy] no ads"})}catch(e){return Promise.reject({code:"m150ad show error",message:e.message})}})}isReady(){return this._curAd&&this._curAd.ready}}class ct extends at{constructor(){super(...arguments),this._strategyName="TestAdsStrategy"}loadAsync(){return Qe.instance.fetchShowConfigAsync().then(n=>m(this,void 0,void 0,function*(){var e=n.ads,t=Math.floor(Math.random()*e.length);const s=new Re(e[t],n.ga_config.id,this.getAdsCallbackOption());return this._curAd=yield s.initAsync(),console.info("test ads load success"),Promise.resolve()})).catch(e=>(console.info("test ads load err: ",e.message),Promise.reject(e)))}}class dt extends Ge{static createRequest(e){return{type:dt.requestType,payload:e}}static createService(){return new dt(dt.requestType,!1,dt.handleRequestAsync)}static handleRequestAsync(t){var e=t.payload.placementId,s=t.payload.isRewardedAd;return t.payload.uid,Le.loadAsync(e,s).then(()=>(console.info("====>load Ads success"),Promise.resolve(Ke(t)))).catch(e=>Promise.resolve(Ve(t,e.code,e.message)))}}dt.requestType="AFGAdInstantLoadService";class lt extends Ge{static createService(){return new lt(lt.requestType,!1,lt.handleRequestAsync)}static createRequest(e){return{type:lt.requestType,payload:e}}static handleRequestAsync(s){return m(this,void 0,void 0,function*(){var e=s.payload.isRewardedAd?Z.reward:Z.next,t=s.payload.placementId;return s.payload.uid,console.info(`===> show ad: ${e}|${t}`),Le.showAsync(s.payload.isRewardedAd).then(()=>(console.info("====>show ads: success"),Promise.resolve(Ke(s)))).catch(e=>(console.info("====>showAdsStrategy show ads: failed: ",e),Promise.resolve(Ve(s,e.code,e.message))))})}}lt.requestType="AFGAdInstantShowService";class ut{constructor(e){this._isRewardedAd=!1,this._uid="",this._placementId=e,this._isRewardedAd=!1,this._uid=(new Date).getTime().toString()}static create(e,t){const s=new ut(e);return s.setRewardedType(t),s}setRewardedType(e){this._isRewardedAd=e}getPlacementID(){return this._placementId}loadAsync(){var e={isRewardedAd:this._isRewardedAd,placementId:this._placementId,uid:this._uid};if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info(`====> Android invoke load ${this._isRewardedAd?"reward":"interstitial"} ad`),We.loadAsync(this._placementId,this._isRewardedAd)}catch(e){return Promise.reject(e)}if(window.MiniGameAds&&window.MiniGameAds.isTest){Qe.createDefaultInstance();var t=i.INTERSTITIAL,t=new ct(this._placementId,!1,t,!0);return Xe.instance.loadAsync(t).then(()=>(console.info("test ad load service return success"),Promise.resolve())).catch(e=>(console.info("test ad load service return error: ",e),Promise.reject(e)))}return Je.instance.invokeServiceAsync(dt.createRequest(e)).then(()=>Promise.resolve()).catch(e=>(console.info("Ad load service return error: ",e),Promise.reject(e)))}showAsync(){var e={isRewardedAd:this._isRewardedAd,placementId:this._placementId,uid:this._uid};if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info(`====> Android invoke show ${this._isRewardedAd?"reward":"interstitial"} ad`),We.showAsync(this._isRewardedAd)}catch(e){return Promise.reject(e)}return window.MiniGameAds&&window.MiniGameAds.isTest?Xe.instance.showAsync().then(()=>(console.info("test ad show service return success"),Promise.resolve())).catch(e=>(console.info("test ad show service return error: ",e),Promise.reject(e))):Je.instance.invokeServiceAsync(lt.createRequest(e)).then(()=>Promise.resolve()).catch(e=>(console.info("Ad show service return error: ",e),Promise.reject(e)))}}class ht{getID(){return"0"}getContextID(){return"0"}getEndTime(){return 0}getTitle(){return""}getPayload(){return""}}e=new class{postScoreAsync(e){return Promise.resolve()}createAsync(e){return o.emptyWaitObject(new ht)}shareAsync(e){return Promise.resolve()}joinAsync(e){return Promise.resolve()}getTournamentsAsync(){return o.emptyWaitObject([])}};const mt=new class{getCatalogAsync(){return o.emptyWaitObject([])}purchaseAsync(e){return o.emptyWaitObject(null)}getPurchasesAsync(){return o.emptyWaitObject([])}consumePurchaseAsync(e){return o.emptyWaitObject(null)}onReady(e){e()}};class gt{constructor(){this._payType="",this.getAvailableGoodsResult=null,this.queryUnConsumeOrderResult=null,this.payResult=null,this.consumeOrderResult=null}getCatalogAsync(){return new Promise((r,o)=>{const e=window.AdInteractive;e||o("Android AdInteractive is not exist"),e.getAvailableGoods(),this.getAvailableGoodsResult=(e,t,s)=>{if(e){console.info("====> getAvailableGoodsResult productInfos: ",t);const n=JSON.parse(t),i=[];n.forEach(e=>{const t={};t.title=e.goodsName,t.description="",t.imageURI="",t.price=e.amount,t.priceCurrencyCode=e.currencyCode,t.productID=e.goodsId,i.push(t)}),r(i)}else o({code:"android_getCatelogAsync_error",message:`${s}`})}})}purchaseAsync(a){return new Promise((r,o)=>{const e=window.AdInteractive;var t;e?(t=R(),e.pay(a.productID,t),this.payResult=(e,t,s,n)=>{if(e){const i={};i.productID=a.productID,i.paymentID="",i.purchaseToken=t,i.purchaseTime=C.getTimestamp().toString(),i.signedRequest="",i.developerPayload=a.developerPayload,this._payType=s,r(i)}else o({code:"android_purchaseAsync_error",message:`${n}`})}):o("Android AdInteractive is not exist")})}getPurchasesAsync(){return new Promise((r,o)=>{const e=window.AdInteractive;e?(e.queryUnConsumeOrder(),this.queryUnConsumeOrderResult=(e,t,s)=>{if(e){console.info("====> queryUnConsumeOrderResult productInfos: ",t);const n=JSON.parse(t),i=[];n.forEach(e=>{const t={};t.purchaseToken=e.id,t.paymentID=e.thirdUid,t.purchaseTime=C.getTimestamp().toString(),t.productID=e.productId,t.signedRequest="",i.push(t)}),r(i)}else o({code:"android_getPurchasesAsync_error",message:`${s}`})}):o("Android AdInteractive is not exist")})}consumePurchaseAsync(t){return new Promise((s,n)=>{const e=window.AdInteractive;e?(e.consume(t,this._payType),this.consumeOrderResult=(e,t)=>{e?s():n({code:"android_consumePurchaseAsync_error",message:`${t}`})}):n("Android AdInteractive is not exist")})}onReady(e){e&&e()}onGetAvailableGoodsResult(e,t,s){console.info(`====> onGetAvailableGoodsResult isSuccess: ${e}, productInfos: ${t}, errorMessage: ${s}`),this.getAvailableGoodsResult?this.getAvailableGoodsResult(e,t,s):console.info("====> getAvailableGoodsResult is not init")}onQueryUnConsumeOrderResult(e,t,s){console.info(`====> onQueryUnConsumeOrderResult isSuccess: ${e}, productInfos: ${t}, errorMessage: ${s}`),this.queryUnConsumeOrderResult?this.queryUnConsumeOrderResult(e,t,s):console.info("====> queryUnConsumeOrderResult is not init")}onPayResult(e,t,s,n){console.info(`====> onPayResult isSuccess: ${e}, orderId: ${t}, errorMessage: ${n}`),this.payResult?this.payResult(e,t,s,n):console.info("====> payResult is not init")}onConsumeOrderResult(e,t){console.info(`====> onComsumeOrderResult isSuccess: ${e}, errorMessage: ${t}`),this.consumeOrderResult?this.consumeOrderResult(e,t):console.info("====> onComsumeOrderResult is not init")}}class yt{constructor(){this._payment=null}static get instance(){return this._instance||(this._instance=new yt),this._instance}init(){var e=window.AdInteractive;this._payment=e?new gt:mt}getCatalogAsync(){return this._payment.getCatalogAsync()}purchaseAsync(e){return this._payment.purchaseAsync(e)}getPurchasesAsync(){return this._payment.getPurchasesAsync()}consumePurchaseAsync(e){return this._payment.consumePurchaseAsync(e)}onReady(e){this._payment.onReady(e)}onGetAvailableGoodsResult(e,t,s){var n;this._payment&&null!==(n=this._payment)&&void 0!==n&&n.onGetAvailableGoodsResult(e,t,s)}onQueryUnConsumeOrderResult(e,t,s){var n;this._payment&&null!==(n=this._payment)&&void 0!==n&&n.onQueryUnConsumeOrderResult(e,t,s)}onPayResult(e,t,s,n){var i;this._payment&&null!==(i=this._payment)&&void 0!==i&&i.onPayResult(e,t,s,n)}onConsumeOrderResult(e,t){var s;this._payment&&null!==(s=this._payment)&&void 0!==s&&s.onConsumeOrderResult(e,t)}}yt._instance=null;const pt=yt.instance;window.onGetAvailableGoodsResult=pt.onGetAvailableGoodsResult.bind(pt),window.onQueryUnConsumeOrderResult=pt.onQueryUnConsumeOrderResult.bind(pt),window.onPayResult=pt.onPayResult.bind(pt),window.onConsumeOrderResult=pt.onConsumeOrderResult.bind(pt);class ft extends Ge{static createRequest(){return{type:ft.requestType}}static createService(){return new ft(ft.requestType,!1,ft.handleRequestAsync)}static handleRequestAsync(t){return pt.getCatalogAsync().then(e=>Promise.resolve(Ke(t,JSON.stringify(e)))).catch(e=>Promise.reject(Ve(t,e.code,e.message)))}}ft.requestType="PayInstantCatalogService";class At extends Ge{static createRequest(e){return{type:At.requestType,payload:e}}static createService(){return new At(At.requestType,!1,At.handleRequestAsync)}static handleRequestAsync(t){return pt.purchaseAsync(t.payload).then(e=>Promise.resolve(Ke(t,e))).catch(e=>Promise.reject(Ve(t,e.code,e.message)))}}At.requestType="PayInstantPurchasesService";class wt extends Ge{static createRequest(){return{type:wt.requestType}}static createService(){return new wt(wt.requestType,!1,wt.handleRequestAsync)}static handleRequestAsync(t){return pt.getPurchasesAsync().then(e=>Promise.resolve(Ke(t,e))).catch(e=>Promise.reject(Ve(t,e.code,e.message)))}}wt.requestType="PayInstantGetPurchasesService";class vt extends Ge{static createRequest(e){return{type:vt.requestType,payload:e}}static createService(){return new vt(vt.requestType,!1,vt.handleRequestAsync)}static handleRequestAsync(t){var e=t.payload;return pt.consumePurchaseAsync(e).then(()=>Promise.resolve(Ke(t))).catch(e=>Promise.reject(Ve(t,e.code,e.message)))}}vt.requestType="PayInstantConsumePurchaseService";class _t extends Ge{static createRequest(e){return{type:_t.requestType,payload:e}}static createService(){return new _t(_t.requestType,!1,_t.handleRequestAsync)}static handleRequestAsync(e){return pt.onReady(e.payload),Promise.resolve(Ke(e))}}function bt(r){return m(this,void 0,void 0,function*(){try{var e=r||function(){const e=new URLSearchParams(window.location.search);let t="minigame-config.json",s=!1;var n;return e.has("mn_config")&&(t=e.get("mn_config"),console.debug("[minigame] config: ",t),s=!0),!s&&e.has("mn_channel")&&(n=e.get("mn_channel"),console.debug("[minigame] channel: ",n),t=n+"-config.json"),t}();if(window.AdInteractive){var t=(i=e,yield new Promise((t,s)=>{const n=new XMLHttpRequest;n.open("GET",i),n.onload=function(){var e;200===n.status?(e=JSON.parse(n.responseText),console.info("config loaded:",e),t(e)):s({message:`fail to get config data from ${i}`})},n.onerror=function(){s({message:"fail to get config data from : "+n.statusText})},n.send()}));return Promise.resolve(t)}{const n=yield fetch(e);var s=yield n.json();return Promise.resolve(s)}}catch(e){return console.error("[minigame] load minigame option error: ",e),Promise.reject(e)}var i})}_t.requestType="PayInstantOnReadyService";window.gaEvent=null;var Pt="1.2.9 b009";let St=!1;const It={version:Pt,init:function(){return m(this,void 0,void 0,function*(){if(St)throw{code:"SDK_ALREADY_INIT",message:"Minigame Sdk has been initialized"};try{var e=yield bt();console.info("[minigame] initSdkAsync options:",e);try{e.ga&&!e.ga.disabled&&function(e){function t(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||t;var s=e.config.gid;s?(console.info("[minigame] init ga with id: "+s),U("https://www.googletagmanager.com/gtag/js?id="+s,!0,e.attributes).then(()=>{}).catch(e=>{console.error("[minigame] init ga error: ",e)}),t("js",new Date),t("config",s,{cookie_flags:"max-age=7200;secure;samesite=none"})):console.warn("[minigame] ga with invalid id: "+s)}(e.ga)}catch(e){console.error("[minigame] initGa error:",e)}try{var t=e.instana;t&&t.enabled&&t.key&&(s=t.key,n=e.app_id,s&&0!==s.length?(console.info("enable instana for game: ",n),i=window,o="ineum",i[r="InstanaEumObject"]||(i[r]=o,(a=i[o]=function(){a.q.push(arguments)}).q=[],a.v=2,a.l=+new Date),window.ineum("reportingUrl","https://eum-orange-saas.instana.io"),window.ineum("key",s),window.ineum("trackSessions"),U("https://eum.instana.io/eum.min.js",!1,{crossorigin:"anonymous",defer:!0}),n&&window.ineum("page","minigame#"+n)):console.warn("[minigame] init instana with invalid token: ",s))}catch(e){}try{e.vconsole&&function(){m(this,void 0,void 0,function*(){window.VConsole?console.info("[minigame] vconsole already loaded"):yield U("https://unpkg.com/vconsole/dist/vconsole.min.js",!1),window.vConsoleInstance=new window.VConsole})}()}catch(e){console.error("[minigame] initVConsole error:",e)}St=!0}catch(e){console.error("Fail to load config file",e)}var s,n,i,r,o,a})},isReady:()=>St};console.info("minigame sdk: "+Pt);const Tt={PROGRESS:"MINIGAME_PROGRESS",INIT:"MINIGAME_INIT",START_GAME:"MINIGAME_START_GAME"};class Rt extends Ge{static createRequest(e){return{type:Rt.requestType,payload:e}}static createService(){return new Rt(Rt.requestType,!1,Rt.handleRequestAsync)}static handleRequestAsync(t){return Le.loadBannerAsync(t.payload).then(()=>Promise.resolve(Ke(t))).catch(e=>Promise.reject(Ve(t,e.code,e.message)))}}Rt.requestType="BannerShowService";class Ct extends Ge{static createRequest(){return{type:Ct.requestType}}static createService(){return new Ct(Ct.requestType,!1,Ct.handleRequestAsync)}static handleRequestAsync(t){return Le.hideBannerAsync().then(()=>Promise.resolve(Ke(t))).catch(e=>Promise.reject(Ve(t,e.code,e.message)))}}Ct.requestType="BannerHideService";class xt{getChannelID(){return""}getInstanceID(){return""}getStateAsync(){return o.emptyWaitObject({show:!1,docked_location:"TOP_LEFT"})}getDisplayRectAsync(){return o.emptyWaitObject({x:0,y:0,width:0,height:0})}setState(e){}destroy(){}}const kt=class Zt{constructor(){this._shareResult=null}static get instance(){return this._instance||(this._instance=new Zt),this._instance}shareAsync(t){return new Promise((s,n)=>{var e;window.AdInteractive?(console.info("====> AdInteractive.share : ",t),window.AdInteractive.share(t.image,null===(e=t.media)||void 0===e?void 0:e.gif.url,null===(e=t.media)||void 0===e?void 0:e.video.url),this._shareResult=(e,t)=>{console.info(`====> onShareResult isSuccess: ${e}`),e?s():n({code:"android share fail",message:t})}):(console.info("====> android share fail by no AdInteractive"),n({code:"android share fail",message:"android share fail by no AdInteractive"}))})}onShareResult(e,t){this._shareResult?this._shareResult(e,t):console.error(`onShareResult === isSuccess : ${e}, errMessage : ${t}`)}}.instance;window.onShareResult=kt.onShareResult.bind(kt);class Dt{constructor(){this._products=[],this._purchasesUnconsumed=[]}static getInstance(){return null==this._instance&&(this._instance=new Dt),this._instance}addProduct(s,n){return m(this,void 0,void 0,function*(){const e={};e.productID=s,e.price=n||"",e.priceCurrencyCode="USD",e.title="",e.description="",e.imageURI="",this._products.push(e);const t={};t.products=this._products,yield V.setDataAsync(t),console.info(`====> addProduct success, products : ${JSON.stringify(this._products)}`)})}getCatalogAsync(){return m(this,void 0,void 0,function*(){try{var e=yield V.getDataAsync(["products"]);return this._products=[],e.products&&0<e.products.length&&(this._products=this._products.concat(e.products)),console.info("====> test getCatalogAsync success, products : "+JSON.stringify(this._products)),o.emptyWaitObject(this._products)}catch(e){return console.error(`====> test getCatalogAsync fail : ${e}`),Promise.reject(e)}})}purchaseAsync(n){return m(this,void 0,void 0,function*(){try{const t=n.productID;this._products.find(e=>e.productID===t);const e={};e.productID=t,e.paymentID="",e.purchaseToken=C.getTimestamp().toString(),e.purchaseTime=C.getTimestamp().toString(),e.signedRequest="",e.developerPayload=n.developerPayload,yield this.getPurchasesAsync(),this._purchasesUnconsumed.push(e);const s={};return s.purchasesUnconsumed=this._purchasesUnconsumed,yield V.setDataAsync(s),console.info(`====> purchaseAsync success, purchasesUnconsumed : ${JSON.stringify(this._purchasesUnconsumed)}`),Promise.resolve(e)}catch(e){return console.error(`====> purchaseAsync fail : ${e}`),Promise.reject(e)}})}getPurchasesAsync(){return this.getPurchasesUnconsumed()}consumePurchaseAsync(s){return m(this,void 0,void 0,function*(){try{var e=this._purchasesUnconsumed.findIndex(e=>e.purchaseToken===s);this._purchasesUnconsumed.splice(e,1)[0];const t={};return t.purchasesUnconsumed=this._purchasesUnconsumed,yield V.setDataAsync(t),console.info(`====> consumePurchaseAsync success, purchasesUnconsumed : ${JSON.stringify(this._purchasesUnconsumed)}`),Promise.resolve()}catch(e){return console.error(`====> consumePurchaseAsync fail : ${e}`),Promise.reject(e)}})}onReady(e){e&&e()}getPurchasesUnconsumed(){return m(this,void 0,void 0,function*(){try{var e=yield V.getDataAsync(["purchasesUnconsumed"]);return e.purchasesUnconsumed&&0<e.purchasesUnconsumed.length&&(this._purchasesUnconsumed=[],this._purchasesUnconsumed=this._purchasesUnconsumed.concat(e.purchasesUnconsumed)),console.info("====> test getPurchasesUnconsumed success, purchasesUnconsumed : "+JSON.stringify(this._purchasesUnconsumed)),o.emptyWaitObject(this._purchasesUnconsumed)}catch(e){return console.error(`====> test getPurchasesUnconsumed fail : ${e}`),Promise.reject(e)}})}}Dt._instance=null;const Et=Dt.getInstance();class Ot extends Ge{static createRequest(e){return{type:Ot.requestType,payload:e}}static createService(){return new Ot(Ot.requestType,!1,Ot.handleRequestAsync)}static handleRequestAsync(t){return kt.shareAsync(t.payload).then(()=>Promise.resolve(Ke(t))).catch(e=>Promise.resolve(Ve(t,e.code,e.message)))}}Ot.requestType="ShareService";class jt{static get instance(){return null==this._instance&&(this._instance=new jt),this._instance}getCatalogAsync(){return console.info("===========> getCatalogAsync"),Je.instance.invokeServiceAsync(ft.createRequest()).then(e=>(console.info("===========> getCatalogAsync success"),Promise.resolve(e.payload))).catch(e=>(console.error("===========> getCatalogAsync fail "+e.message),Promise.reject({code:"getCatalogAsync fail",message:e.message})))}purchaseAsync(t){return console.info("===========> purchaseAsync"),Je.instance.invokeServiceAsync(At.createRequest(t)).then(e=>(console.info(`===========> purchaseAsync ${t.productID} success`),console.info(`===========> purchaseAsync payload: ${JSON.stringify(e.payload)}`),Promise.resolve(e.payload))).catch(e=>(console.error(`===========> purchaseAsync ${t.productID} ${e.message}`),Promise.reject({code:"purchaseAsync fail",message:e.message})))}getPurchasesAsync(){return console.info("===========> getPurchasesAsync"),Je.instance.invokeServiceAsync(wt.createRequest()).then(e=>(console.info("===========> getPurchasesAsync success"),Promise.resolve(e.payload))).catch(e=>(console.error("===========> getPurchasesAsync "+e.message),Promise.reject({code:"getPurchasesAsync fail",message:e.message})))}consumePurchaseAsync(t){return console.info("===========> consumePurchaseAsync"),Je.instance.invokeServiceAsync(vt.createRequest(t)).then(e=>(console.info(`===========> consumePurchaseAsync ${t} success`),Promise.resolve())).catch(e=>(console.error(`===========> consumePurchaseAsync ${t} ${e.message}`),Promise.reject({code:"consumePurchaseAsync fail",message:e.message})))}onReady(e){return m(this,void 0,void 0,function*(){console.info("===========> onReady"),yield Je.instance.invokeServiceAsync(_t.createRequest(e)).then(()=>{console.info("===========> onReady success")}).catch(e=>{console.error("===========> onReady fail "+e.message)})})}}jt._instance=null;const Nt=jt.instance;let Bt,qt,$t;var Mt=class{static requestAsync(e,t,s){return o.emptyWaitUnsupportApi("FBInstant.graphApi.requestAsync")}},Ut=class{static getArenasAsync(){return o.emptyWaitObject([])}},Ft=class{static getAsync(e){return o.emptyWaitObject(null)}static createAsync(e){return o.emptyWaitObject(null)}static getPlayerSquadsAsync(){return o.emptyWaitObject([])}static canUseSquadsAsync(){return o.emptyWaitObject(!1)}},Lt=class{static canGetLiveStreamsAsync(){return o.emptyWaitObject(!1)}static canFollowOfficialPageAsync(){return o.emptyWaitObject(!1)}static canJoinOfficialGroupAsync(){return o.emptyWaitObject(!1)}static getLiveStreamsAsync(e){return o.emptyWaitObject([])}static liveStreamsOverlayAsync(){return o.emptyWait()}static followOfficialPageAsync(){return o.emptyWait()}static joinOfficialGroupAsync(){return o.emptyWait()}},Wt=class{static createAsync(e,t){return o.emptyWaitObject(null)}static getInstancesAsync(){return o.emptyWaitObject([])}},Gt=class{static showAsync(){return o.emptyWait()}static getCurrentMatchAsync(){return o.emptyWaitObject(null)}static loadCameraEffectAsync(e){return o.emptyWaitObject(null)}static clearCameraEffectAsync(){return o.emptyWait()}},zt=class{static createAsync(e){return o.emptyWaitObject(new xt)}},Pt=class{static unlockItemAsync(e){return o.emptyWaitUnsupportApi("FBInstant.inventory.unlockItemAsync")}},Pt=Object.freeze({__proto__:null,get player(){return Bt},get context(){return qt},get payments(){return $t},getLocale:function(){return navigator.language},getPlatform:function(){return void 0===T&&(T=(e=navigator.userAgent||navigator.vendor||window.opera,!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))))),T?"MOBILE_WEB":"WEB";var e},getSDKVersion:function(){return"7.0"},initializeAsync:function(e){return m(this,void 0,void 0,function*(){try{Je.instance.invokeQuickServiceAsync(Tt.INIT,!0),yield Q(()=>It.isReady()),Bt=J.currentPlayer,qt=p.currentContext}catch(e){console.error("initializeAsync error:",e)}return o.emptyWait()})},setLoadingProgress:function(e){"number"!=typeof e&&(e=parseFloat(e)),e=isNaN(e)?0:e,e=Math.min(100,e),e=Math.max(0,e),Je.instance&&Je.instance.invokeQuickServiceAsync(Tt.PROGRESS,!0,{progress:e})},getSupportedAPIs:function(){return["getLocale","getPlatform","getSDKVersion","getSupportedAPIs","getEntryPointData","logEvent","onPause","inventory.unlockItemAsync","matchPlayerAsync","initializeAsync","setLoadingProgress","setSessionData","startGameAsync","player.getID","player.getName","player.getPhoto","player.flushDataAsync","player.getDataAsync","player.setDataAsync","player.subscribeBotAsync","player.getConnectedPlayersAsync","player.getSignedPlayerInfoAsync","player.canSubscribeBotAsync","player.getStatsAsync","player.setStatsAsync","player.incrementStatsAsync","context.getID","context.getType","context.isSizeBetween","context.switchAsync","context.chooseAsync","context.createAsync","context.getPlayersAsync","payments.getCatalogAsync","payments.purchaseAsync","payments.getPurchasesAsync","payments.consumePurchaseAsync","payments.onReady","getInterstitialAdAsync","getRewardedVideoAsync","loadBannerAdAsync","hideBannerAdAsync","shareAsync","switchGameAsync","quit","canCreateShortcutAsync","createShortcutAsync","getEntryPointAsync","getLeaderboardAsync","checkCanPlayerMatchAsync","postSessionScore","updateAsync"]},getEntryPointData:function(){return{}},getEntryPointAsync:function(){return o.emptyWaitString("UNKNOWN")},setSessionData:function(e){},startGameAsync:function(){return Je.instance.invokeQuickServiceAsync(Tt.START_GAME,!0),$t=window.MiniGameAds&&window.MiniGameAds.isTest?(console.info("====> MiniGameAds is test mode"),Et):(console.info("====> MiniGameAds is normal mode"),Nt),o.emptyWait()},shareAsync:function(t){return window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp?kt.shareAsync(t):Je.instance.invokeServiceAsync(Ot.createRequest(t)).then(()=>Promise.resolve()).catch(e=>(console.info(`shareAsync ${t} error: `,e),Promise.reject(e)))},updateAsync:function(e){return o.emptyWait()},switchGameAsync:function(e,t){return o.emptyWait()},canCreateShortcutAsync:function(){return o.emptyWaitBool(!1)},createShortcutAsync:function(){return o.emptyWait()},quit:function(){},logEvent:function(e,t,s){if(void 0===window.gaEvent)return console.warn("===> gaEvent not init"),{};console.info("logging event: ",e,s);let n,i,r;s&&(n=s.category,i=s.label,r=s.nonInteraction);const o=window.gtag;return o&&o("event",e,{event_category:n,event_label:i,non_interaction:r||!0}),{}},onPause:function(e){},getInterstitialAdAsync:function(e){return o.emptyWaitObject(ut.create(e,!1))},getRewardedInterstitialAsync:function(e){return o.emptyWaitObject(ut.create(e,!1))},getRewardedVideoAsync:function(e){return o.emptyWaitObject(ut.create(e,!0))},matchPlayerAsync:function(e,t,s){return o.emptyWait()},checkCanPlayerMatchAsync:function(){return o.emptyWaitBool(!1)},getLeaderboardAsync:function(e){return o.emptyWaitUnsupportApi("FBInstant.getLeaderboardAsync")},postSessionScore:function(e){},bCustomInit:!0,loadBannerAdAsync:function(t){if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info("====> Android invoke loadBannerAdAsync"),We.loadBannerAdAsync(t)}catch(e){return console.info("====> Android invoke loadBannerAdAsync error: ",e.messgae),Promise.reject(e)}return window.MiniGameAds&&window.MiniGameAds.isTest?et.showBannerAsync(t):Je.instance.invokeServiceAsync(Rt.createRequest(t)).then(()=>Promise.resolve()).catch(e=>(console.info(`banner ${t} show error: `,e),Promise.reject(e)))},hideBannerAdAsync:function(){if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info("====> Android invoke hideBannerAdAsync"),We.hideBannerAdAsync()}catch(e){return console.info("====> Android invoke hideBannerAdAsync error: ",e.messgae),Promise.reject(e)}return window.MiniGameAds&&window.MiniGameAds.isTest?et.hideBannerAsync():Je.instance.invokeServiceAsync(Ct.createRequest()).then(()=>Promise.resolve()).catch(e=>(console.info("banner hide error: ",e),Promise.reject(e)))},tournament:e,getTournamentAsync:function(){return o.emptyWaitObject(new ht)},canSwitchNativeGameAsync:function(){return o.emptyWaitBool(!1)},postSessionScoreAsync:function(e){},inviteAsync:function(){return o.emptyWaitUnsupportApi("FBInstant.inviteAsync")},graphApi:Mt,arenas:Ut,squads:Ft,community:Lt,videoPlayer:Wt,room:Gt,liveVideoCommentView:zt,inventory:Pt});Je.createDefaultInstance(window.parent),Je.instance.start(),window.FBInstant=Pt,window.minigame_sdk=It,window.mediationClient=Je.instance,It.init()});
